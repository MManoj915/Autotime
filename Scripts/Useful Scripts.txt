IM_POLICYFINANCE_VAT 

SELECT MEMBERCODE,REINSMEMBERCODE,MEMBERPOLICYCODE,ACARDID FROM IM_MEMBERPOLICY WHERE (ACARDID,POLICYCODE) IN
(SELECT ACARDID,POLICYCODE FROM(SELECT ACARDID,POLICYCODE,Sum(FINANCEPOSTDONEFORADDITION*1+FINANCEPOSTDONEFORDELETION*-1)CNT FROM IM_MEMBERPOLICY WHERE POLICYCODE IN
(SELECT POLICYCODE FROM IM_POLICY WHERE SYSDATE BETWEEN STARTDATE AND ENDDATE)
AND TYPEE=1 GROUP BY ACARDID,POLICYCODE
HAVING Count(*) > 1)WHERE CNT <> 0 )
ORDER BY ACARDID






SELECT * FROM(SELECT Sum(Decode(REFUNDPREMIUM,0,-1,1)) TAXINVOICE,CARD_NO FROM IM_TPAPRODUCTIONDTL WHERE CARD_NO IN
(SELECT CARD_NO FROM IM_TPAPRODUCTIONDTL 
GROUP BY CARD_NO,NGI_POLICY_NO
HAVING Count(*) > 1) AND NGI_POLICY_NO IN
((SELECT NGI_POLICY_NO FROM IM_TPAPRODUCTIONDTL 
GROUP BY CARD_NO,NGI_POLICY_NO
HAVING Count(*) > 1)) AND (ADDPREMIUM+REFUNDPREMIUM) <> 0 GROUP BY  CARD_NO) WHERE TAXINVOICE <> 0



SELECT * FROM IM_TPAPRODUCTIONDTL WHERE CARD_NO='3505-1-2016-1'
                                                                   

SELECT * FROM IM_TPAPRODUCTIONDTL WHERE CARD_NO IN
(SELECT CARD_NO FROM IM_TPAPRODUCTIONDTL 
GROUP BY CARD_NO,NGI_POLICY_NO
HAVING Count(*) > 1) AND NGI_POLICY_NO IN
((SELECT NGI_POLICY_NO FROM IM_TPAPRODUCTIONDTL 
GROUP BY CARD_NO,NGI_POLICY_NO
HAVING Count(*) > 1))  ORDER BY CARD_NO
SELECT ROWNUM AS SNO,'NEXTCARE-ENHANCEDEBP' ADMINISTRATEDBY,MP.APOLICYID POLICYID,MP.APOLICYNAME POLICYNAME,
NULL SUBGROUPNAME,A_STAFF_ID,ACARDID CARDNUMBER,C.CATEGORY_ID,M.FIRST_NAME,M.MIDDLENAME,Nvl(M.LAST_NAME,M.FIRST_NAME) LAST_NAME,
Decode(M.RELATION,77,NULL,78,NULL,0,NULL,15,NULL,M1.FIRST_NAME) PRINCIPALNAME,To_Date(M.DATE_OF_BIRTH,'DD/MM/RRRR') DATEOFBIRTH,
Decode(M.RELATION,77,'Principal',78,'Principal',0,'Principal',15,'Principal',1,'Child',4,'Spouse',5,'Child',8,'Spouse',11,'Child',79,'Spouse',82,'Child')
Dependency,G.CONSTANTNAME GENDER,G1.CONSTANTNAME MARITALSTATUS,To_Char(M.COVERED_FROM_DATE,'DD/MM/RRRR') EFFECTIVEDATE,NULL REMARKS,
G2.CONSTANTNAME NATIONALITY,Nvl(M.MOBILE_NO,M.MOBILE_NUMBER) MOBILENBR,M.EMAIL_ID,
M.EMIRATES_ID,G3.CONSTANTNAME SALARY,'No' COMMISSION,'United Arab Emirates' COUNTRY,
G4.CONSTANTNAME REGION,'DUBAI (DISTRICT UNKNOWN)' SUBREGION,M.PASSPORT_NO,M.UIDNUMBER,'Dubai' VISAPLACE
FROM IM_MEMBERPOLICY MP
JOIN IM_CATEGORIES C ON C.CATEGORY_CODE = MP.CATEGORYCODE 
JOIN IM_MEMBERS M ON M.MEMBER_CODE = MP.MEMBERCODE AND M.POLICYCODE = MP.POLICYCODE
LEFT JOIN IM_MEMBERS M1 ON M1.MEMBER_CODE = M.PARENT_ID  
LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'GENDER' AND Upper(G.LANGUAGECODE) = 'EN-US' AND G.CONSTANTVALUE = M.GENDER
LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'MARITAL_STATUS' AND Upper(G1.LANGUAGECODE) = 'EN-US' AND G1.CONSTANTVALUE = M.MARITAL_STATUS
LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'FND_NATIONALITY' AND Upper(G2.LANGUAGECODE) = 'EN-US' AND G2.CONSTANTVALUE = M.NATIONALITY
LEFT JOIN GENCONSTANT G3 ON G3.CATEGORY = 'SALARYBANDTYPE' AND Upper(G3.LANGUAGECODE) = 'EN-US' AND G3.CONSTANTVALUE = M.SALARYBAND
LEFT JOIN GENCONSTANT G4 ON G4.CATEGORY = 'MEMBERLOCATION' AND Upper(G4.LANGUAGECODE) = 'EN-US' AND G4.CONSTANTVALUE = M.LOCATION
LEFT JOIN GENCONSTANT G5 ON G5.CATEGORY = 'MEMBERLOCATION' AND Upper(G5.LANGUAGECODE) = 'EN-US' AND G5.CONSTANTVALUE = M.WORKLOCATION   
WHERE MP.POLICYCODE IN(100000000000024295,100000000000024271)
AND TYPEE = 1
                                                    


      
                                  
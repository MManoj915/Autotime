INSERT INTO IM_FRAUD_CLAIMS_VW  
SELECT P.PROVIDERID,P.PROVIDERNAME,A.SENDER_ID,H.ACR_FORM_NO,H.INVOICENUMBER,Nvl(H.CARDNO,MEMBER_ID) CARDNO,
AMEMBERNAME,APOLICYID,APOLICYNAME,TRANSACTIONDATE,ENCOUNTER_START,ENCOUNTER_END,A.CLAIM_NET,
Round((DECODE(H.CLAIM_STATUS, 2, H.APPROVED_AMOUNT, 0) +
NVL((SELECT SUM(DENIEDAMOUNT) DENIEDAMOUNT
FROM IM_CLAIM_PROCESS_DETAIL_DTL D
WHERE D.DENIEDFOR = 2
AND D.ACTIVITY_DETAIL_CODE IN
(SELECT ACTIVITY_DETAIL_CODE
FROM IM_CLAIM_PROCESS_DETAIL DTL
WHERE DTL.CLAIM_CODE = H.CLAIM_CODE)),
0)),2) PAIDAMOUNT,Round( 
NVL((SELECT SUM(DENIEDAMOUNT) DENIEDAMOUNT
FROM IM_CLAIM_PROCESS_DETAIL_DTL D
WHERE D.DENIEDFOR <> 2
AND D.ACTIVITY_DETAIL_CODE IN
(SELECT ACTIVITY_DETAIL_CODE
FROM IM_CLAIM_PROCESS_DETAIL DTL
WHERE DTL.CLAIM_CODE = H.CLAIM_CODE)),
0),2)  DECLINEDAMOUNT,
(SELECT SUM(REQUEST_AMOUNT) FROM IM_ECLAIMS_ERR_F WHERE SYS_CLAIM_ID = A.SYS_CLAIM_ID) UNAUTHORIZEDAMOUNT,'High' RISKLEVEL,'RULE12' RULETYPE FROM  
ECLAIMS_F A,IM_CLAIM_PROCESS_HEADER H,IM_PROVIDERS P,IM_MEMBERPOLICY MP
WHERE  A.SYS_CLAIM_ID = H.MAP_VALUE AND H.RESUBMISSION_COMMENTS IS NULL AND SYS_CLAIM_ID IN
(SELECT SYS_CLAIM_ID FROM IM_ECLAIMS_ERR_F WHERE ERROR_CODE='RULE12') AND H.PROVIDER_CODE = P.PROVIDERCODE AND H.MEMBERPOLICYCODE = MP.MEMBERPOLICYCODE     


                              
 CREATE TABLE IM_CLAIM_SIBMISSION_VW AS SELECT P.PROVIDERID,P.PROVIDERNAME,A.SENDER_ID,H.ACR_FORM_NO,H.INVOICENUMBER,Nvl(H.CARDNO,MEMBER_ID) CARDNO,
AMEMBERNAME,APOLICYID,APOLICYNAME,TRANSACTIONDATE,ENCOUNTER_START,ENCOUNTER_END,A.CLAIM_NET,
Round((DECODE(H.CLAIM_STATUS, 2, H.APPROVED_AMOUNT, 0) +
NVL((SELECT SUM(DENIEDAMOUNT) DENIEDAMOUNT
FROM IM_CLAIM_PROCESS_DETAIL_DTL D
WHERE D.DENIEDFOR = 0
AND D.ACTIVITY_DETAIL_CODE IN
(SELECT ACTIVITY_DETAIL_CODE
FROM IM_CLAIM_PROCESS_DETAIL DTL
WHERE DTL.CLAIM_CODE = H.CLAIM_CODE)),
0)),2) PAIDAMOUNT,Round( 
NVL((SELECT SUM(DENIEDAMOUNT) DENIEDAMOUNT
FROM IM_CLAIM_PROCESS_DETAIL_DTL D
WHERE D.DENIEDFOR <> 2
AND D.ACTIVITY_DETAIL_CODE IN
(SELECT ACTIVITY_DETAIL_CODE
FROM IM_CLAIM_PROCESS_DETAIL DTL
WHERE DTL.CLAIM_CODE = H.CLAIM_CODE)),
0),2)  DECLINEDAMOUNT FROM  
ECLAIMS_F A,IM_CLAIM_PROCESS_HEADER H,IM_PROVIDERS P,IM_MEMBERPOLICY MP
WHERE A.SYS_CLAIM_ID = H.MAP_VALUE    AND H.PROVIDER_CODE = P.PROVIDERCODE AND H.MEMBERPOLICYCODE = MP.MEMBERPOLICYCODE
                                 
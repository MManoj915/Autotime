IF LOGINTYPE = 1 THEN
SELECT POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME GROUPNAME,Nvl(GRP1.GROUP_NAME,GRP.GROUP_NAME) SUBGROUPNAME FROM IM_POLICY POL
JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = POL.GROUPCODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.PARENT_GROUP = GRP.GROUP_CODE     
WHERE   POL.AUTHORIZEDSTATUS=1 AND (POL.ENDDATE BETWEEN SYSDATE-60 AND SYSDATE OR 
POL.ENDDATE BETWEEN SYSDATE AND SYSDATE+365)   
ELSIF LOGINTYPE = 2 THEN
SELECT POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME GROUPNAME,Nvl(GRP1.GROUP_NAME,GRP.GROUP_NAME) SUBGROUPNAME FROM IM_POLICY POL
JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = POL.GROUPCODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.PARENT_GROUP = GRP.GROUP_CODE     
WHERE   POL.AUTHORIZEDSTATUS=1 AND (POL.ENDDATE BETWEEN SYSDATE-60 AND SYSDATE OR 
POL.ENDDATE BETWEEN SYSDATE AND SYSDATE+365)
AND POL.AGENTCODE = "+FILTERCODE+"
ELSIF LOGINTYPE = 3 THEN
SELECT POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME GROUPNAME,Nvl(GRP1.GROUP_NAME,GRP.GROUP_NAME) SUBGROUPNAME FROM IM_POLICY POL
JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = POL.GROUPCODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.PARENT_GROUP = GRP.GROUP_CODE     
WHERE   POL.AUTHORIZEDSTATUS=1 AND (POL.ENDDATE BETWEEN SYSDATE-60 AND SYSDATE OR 
POL.ENDDATE BETWEEN SYSDATE AND SYSDATE+365)
AND POL.BROKERCODE = "+FILTERCODE+"
ELSIF LOGINTYPE = 4 OR LOGINTYPE = 6 THEN
SELECT POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME GROUPNAME,Nvl(GRP1.GROUP_NAME,GRP.GROUP_NAME) SUBGROUPNAME FROM IM_POLICY POL
JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = POL.GROUPCODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.PARENT_GROUP = GRP.GROUP_CODE     
WHERE   POL.AUTHORIZEDSTATUS=1 AND (POL.ENDDATE BETWEEN SYSDATE-60 AND SYSDATE OR 
POL.ENDDATE BETWEEN SYSDATE AND SYSDATE+365)
AND POL.GROUPCODE = "+FILTERCODE+"   
END IF;


 


                               
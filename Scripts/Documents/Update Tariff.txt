DECLARE L_NETWORKCODE NUMBER;L_PRICE NUMBER(19,2);
BEGIN
FOR HDR IN(SELECT H.POLICYCODE,H.CATEGORY_CODE,A.ACTIVITY_DETAIL_CODE,H.PROVIDER_CODE,D.CODE,A.ACTIVITYSTARTDATE,PRICE,PROVIDERNETPRICE FROM IM_CLAIM_PROCESS_DETAIL A,IM_CLAIM_PROCESS_HEADER H,IM_VERSION_DETALIS D WHERE
A.CLAIM_CODE = H.CLAIM_CODE AND  H.PROVIDER_CODE IN
(SELECT PROVIDERCODE FROM IM_PROVIDERS WHERE PROVIDERID ='M731') AND Nvl(H.AUTHORIZEDSTATUS,0) = 0 AND A.VERSIONDETAILCODE = D.DETAILCODE AND PRICE <> 0 ) LOOP
SELECT  Max(IPCN.NETWORKCODE) INTO L_NETWORKCODE  FROM IM_POLICY POL
LEFT JOIN IM_POLICY_CATEGORYDTL DTL ON DTL.POLICYCODE = POL.POLICYCODE
LEFT JOIN IM_POLICYCOVEREDNETWORK IPCN ON IPCN.PCDCODE = DTL.PCDCODE
WHERE POL.POLICYCODE = HDR.POLICYCODE  AND POL.POLICYCODE = HDR.POLICYCODE AND DTL.CATEGORYCODE = HDR.CATEGORY_CODE
AND Nvl(IPCN.ACTIVE,0) = 1;   
L_PRICE:=NGI_LOADCLAIMS.NGI_GETDHATARIFFPRICE(1,HDR.PROVIDER_CODE,HDR.CODE,HDR.ACTIVITYSTARTDATE,L_NETWORKCODE);
UPDATE IM_CLAIM_PROCESS_DETAIL SET PRICE = L_PRICE,PROVIDERNETPRICE = L_PRICE WHERE ACTIVITY_DETAIL_CODE=HDR.ACTIVITY_DETAIL_CODE;
COMMIT;
END LOOP;
END;




DECLARE L_NETWORKCODE NUMBER;L_PRICE NUMBER(19,2);
BEGIN
FOR HDR IN(SELECT A.SYS_ACTIVITY_STATUS,H.POLICYCODE,H.CATEGORY_CODE,A.ACTIVITY_DETAIL_CODE,H.PROVIDER_CODE,D.CODE,A.ACTIVITYSTARTDATE,PRICE,PROVIDERNETPRICE FROM IM_CLAIM_PROCESS_DETAIL A,IM_CLAIM_PROCESS_HEADER H,IM_VERSION_DETALIS D WHERE
A.CLAIM_CODE = H.CLAIM_CODE AND  H.PROVIDER_CODE IN
(SELECT PROVIDERCODE FROM IM_PROVIDERS WHERE PROVIDERID ='M731') AND Nvl(H.AUTHORIZEDSTATUS,0) = 0 AND A.VERSIONDETAILCODE = D.DETAILCODE AND Nvl(A.TYPE,0) = 0 ) LOOP
SELECT  Max(IPCN.NETWORKCODE) INTO L_NETWORKCODE  FROM IM_INDIVIDUALPOLICY POL
LEFT JOIN IM_NGIINDPOLICYCATEGORY DTL ON DTL.INDIVIDUALPOLICYCODE = POL.INDIVIDUALPOLICYCODE
LEFT JOIN IM_INDIVIDUALPOLICYNETWORK IPCN ON IPCN.POLICYCATEGORYCODE = DTL.POLICYCATEGORYCODE
WHERE POL.INDIVIDUALPOLICYCODE = HDR.POLICYCODE  AND POL.INDIVIDUALPOLICYCODE = HDR.POLICYCODE AND DTL.CATEGORYCODE = HDR.CATEGORY_CODE
AND Nvl(IPCN.ACTIVE,0) = 1;   
L_PRICE:=NGI_LOADCLAIMS.NGI_GETDHATARIFFPRICE(1,HDR.PROVIDER_CODE,HDR.CODE,HDR.ACTIVITYSTARTDATE,L_NETWORKCODE);
UPDATE IM_CLAIM_PROCESS_DETAIL SET PRICE = L_PRICE,PROVIDERNETPRICE = L_PRICE,SYS_ACTIVITY_STATUS=NULL WHERE ACTIVITY_DETAIL_CODE=HDR.ACTIVITY_DETAIL_CODE;
COMMIT;
END LOOP;
END;


DECLARE L_DETAILCODE NUMBER;
BEGIN
FOR HDR IN(SELECT * FROM IM_CLAIM_PROCESS_HEADER WHERE ACTCHECKHDR IS NOT NULL AND PRIOR_AUTHORIZATION_ID IS NOT NULL) LOOP

FOR DTL IN(SELECT * FROM IM_CD1 WHERE SYS_CLAIM_ID = HDR.ACTCHECKHDR ) LOOP

UPDATE IM_CD SET TEMPD = DTL.SYS_ACTIVITY_ID WHERE VERSIONDETAILCODE IN(
SELECT DETAILCODE FROM IM_VERSION_DETALIS WHERE Upper(REPLACE(CODE,'-','')) = Upper(REPLACE(DTL.ACTIVITY_CODE,'-','')))
AND CLAIM_CODE = HDR.CLAIM_CODE;
COMMIT;

END LOOP;

END LOOP;
END;





CREATE TABLE IM_CD AS SELECT * FROM IM_CLAIM_PROCESS_DETAIL WHERE CLAIM_CODE IN
(SELECT CLAIM_CODE FROM IM_CLAIM_PROCESS_HEADER WHERE ACTCHECKHDR IS NOT NULL AND PRIOR_AUTHORIZATION_ID IS NOT NULL)

CREATE TABLE IM_CD1 AS SELECT * FROM EPRIOR_ACTIVITIES_1    WHERE SYS_CLAIM_ID IN
(SELECT ACTCHECKHDR FROM IM_CLAIM_PROCESS_HEADER WHERE ACTCHECKHDR IS NOT NULL AND PRIOR_AUTHORIZATION_ID IS NOT NULL)

 SELECT SYS_CLAIM_ID FROM EPRIOR_ACTIVITIES_1 WHERE SYS_CLAIM_ID IN(SELECT SYS_CLAIM_ID FROM IM_T1)
 GROUP BY SYS_CLAIM_ID,ACTIVITY_CODE HAVING Count(*) > 1


UPDATE IM_PR_SPONSOR_APPLICATION SET CREATEDBY=100000000000000074  WHERE SPONSOR_CODE=100000000000002522

SELECT * FROM IM_PR_SPONSOR_APPLICATION  WHERE SPONSOR_CODE=100000000000002522
UPDATE IM_PR_SPONSOR SET ADMINISTRATEDDTLCODE = NULL WHERE SPONSOR_CODE=100000000000002522

SELECT * FROM IM_PR_SPONSOR   WHERE SPONSOR_CODE=100000000000002522

SELECT * FROM IM_PR_BASERATES WHERE
RELATION = Decode(4,1,77,2,8,3,4,4,1,5,5,6,77,7,77,8,2,9,6,10,3,11,7)
AND MARITAL_STATUS = Decode(1,1,0,2,1,3,2,4,3)
AND Decode(OWNERCODE,7,1,21,3,OWNERCODE) =  1
AND Nvl(PLANCODE,0) = Nvl(NULL,0) AND GENDER =0
AND SOURCE = 4 AND ACTIVE = 1 AND CEIL(MONTHS_BETWEEN(SYSDATE,To_Date('07/07/2008','DD/MM/RRRR')) / 12)
BETWEEN FROMAGE AND TOAGE AND ROWNUM < 2;


SELECT * FROM IM_PR_STAFF   WHERE STAFFCODE =100000000000000067
END IF;



SELECT * FROM IM_PR_ADMINISTRATED_DTL

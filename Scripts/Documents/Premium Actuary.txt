INSERT INTO IM_PREMIUM_ACTUARY1 SELECT JV.REF_NO,JV.REFDATE,MEMP.ACARDID,MEMP.AMEMBERNAME,To_Char(MEMP.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
MEMP.APOLICYID,MEMP.APOLICYNAME,To_Char(MEMP.MEMBERSTARTDATE,'DD/MM/RRRR') MEMBERSTARTDATE,
To_Char(MEMP.MEMBERENDDATE,'DD/MM/RRRR') MEMBERENDDATE,G.CONSTANTNAME,VAT.ADDITIONAMOUNT,VAT.DELETIONAMOUNT,To_Char(POL.STARTDATE,'RRRR') UWYEAR,
POL.NGI_FEES,JV.AMOUNT,VAT.POLICYFINANCEPOSTINGCODE,VAT.MEMBERPOLICYCODE,1 POLICYTYPE,POL.POLICYCODE,
MEMP.CATEGORYCODE,NULL,NULL,NULL,NULL,POL.STARTDATE,POL.ENDDATE,VAT.VATAMOUNT,POL.NGI_FEES,
VAT.ADDITIONDATE,VAT.DELETIONDATE,VAT.VATAMOUNT,VAT.REFUNDVATAMOUNT FROM IM_POLICYFINANCE_VAT  VAT
JOIN IM_NGI_JVPOSTING JV ON JV.REF_CODE = VAT.POLICYFINANCEPOSTINGCODE  --AND Nvl(JV.GROUPCODE,VAT.GROUPCODE) = VAT.GROUPCODE AND Nvl(JV.SESSIONPROCESSDONE,77) = Nvl(VAT.RELATIONNAME,77)
LEFT JOIN IM_MEMBERPOLICY MEMP ON MEMP.MEMBERPOLICYCODE = VAT.MEMBERPOLICYCODE   
LEFT JOIN IM_POLICY POL ON POL.POLICYCODE = JV.POLICYCODE
LEFT JOIN GENCONSTANT G ON G.CATEGORY='NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND Upper(G.LANGUAGECODE) = 'EN-US'
WHERE  To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND POLICYFINANCEPOSTINGCODE IN(SELECT REF_CODE FROM (SELECT Sum(Decode(MEMOTYPE,0,Abs(AMOUNT),Abs(AMOUNT)*-1)) AMOUNT,REF_CODE FROM IM_NGI_JVPOSTING WHERE To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND REF_CODE IS NOT NULL AND JVPREMIUMTYPE = 0 GROUP BY REF_CODE) WHERE AMOUNT <> 0 )
AND JV.POLICYTYPE = 0 AND Nvl(JV.BENEFITCODE,1) = 1 AND Nvl(JV.JVPREMIUMTYPE,0) = 0  AND JV.MEMOTYPE = 1
AND JV.REF_NO='01191118891' AND JV.REF_NO NOT IN(SELECT ENDORESMENTID FROM IM_EFORM_UW_HDR_TEM)  AND ADDITIONAMOUNT <> 0 ;

                            

INSERT INTO IM_PREMIUM_ACTUARY1 SELECT JV.REF_NO,JV.REFDATE,MEMP.ACARDID,MEMP.AMEMBERNAME,To_Char(MEMP.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
MEMP.APOLICYID,MEMP.APOLICYNAME,To_Char(MEMP.MEMBERSTARTDATE,'DD/MM/RRRR') MEMBERSTARTDATE,
To_Char(MEMP.MEMBERENDDATE,'DD/MM/RRRR') MEMBERENDDATE,G.CONSTANTNAME,VAT.ADDITIONAMOUNT,VAT.DELETIONAMOUNT,To_Char(POL.STARTDATE,'RRRR') UWYEAR,
POL.NGI_FEES,JV.AMOUNT,VAT.POLICYFINANCEPOSTINGCODE,VAT.MEMBERPOLICYCODE,1 POLICYTYPE,POL.POLICYCODE,
MEMP.CATEGORYCODE,NULL,NULL,NULL,NULL,POL.STARTDATE,POL.ENDDATE,REFUNDVATAMOUNT,POL.NGI_FEES,
VAT.ADDITIONDATE,VAT.DELETIONDATE,VAT.VATAMOUNT,VAT.REFUNDVATAMOUNT*-1 FROM IM_POLICYFINANCE_VAT1  VAT
JOIN IM_NGI_JVPOSTING JV ON JV.REF_CODE = VAT.POLICYFINANCEPOSTINGCODE  AND Nvl(JV.GROUPCODE,VAT.GROUPCODE) = VAT.GROUPCODE AND Nvl(JV.SESSIONPROCESSDONE,77) = Nvl(VAT.RELATIONNAME,77)
LEFT JOIN IM_MEMBERPOLICY MEMP ON MEMP.MEMBERPOLICYCODE = VAT.MEMBERPOLICYCODE   
LEFT JOIN IM_POLICY POL ON POL.POLICYCODE = JV.POLICYCODE
LEFT JOIN GENCONSTANT G ON G.CATEGORY='NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND Upper(G.LANGUAGECODE) = 'EN-US'
WHERE  To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND POLICYFINANCEPOSTINGCODE IN(SELECT REF_CODE FROM (SELECT Sum(Decode(MEMOTYPE,0,Abs(AMOUNT),Abs(AMOUNT)*-1)) AMOUNT,REF_CODE FROM IM_NGI_JVPOSTING WHERE To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND REF_CODE IS NOT NULL AND JVPREMIUMTYPE = 0 GROUP BY REF_CODE) WHERE AMOUNT <> 0 )
AND JV.POLICYTYPE = 0 AND Nvl(JV.BENEFITCODE,1) = 1 AND Nvl(JV.JVPREMIUMTYPE,0) = 0  AND JV.MEMOTYPE = 0
AND JV.REF_NO NOT IN(SELECT ENDORESMENTID FROM IM_EFORM_UW_HDR_TEM)  AND DELETIONAMOUNT <> 0 ;

INSERT INTO IM_PREMIUM_ACTUARY1 SELECT JV.REF_NO,JV.REFDATE,MEMP.ACARDID,MEMP.AMEMBERNAME,To_Char(MEMP.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
MEMP.APOLICYID,MEMP.APOLICYNAME,To_Char(MEMP.MEMBERSTARTDATE,'DD/MM/RRRR') MEMBERSTARTDATE,
To_Char(MEMP.MEMBERENDDATE,'DD/MM/RRRR') MEMBERENDDATE,G.CONSTANTNAME,VAT.ADDITIONAMOUNT,VAT.DELETIONAMOUNT,To_Char(POL.STARTDATE,'RRRR') UWYEAR,
POL.NGI_FEES,JV.AMOUNT,VAT.POLICYFINANCEPOSTINGCODE,VAT.MEMBERPOLICYCODE,2 POLICYTYPE,POL.INDIVIDUALPOLICYCODE,
MEMP.CATEGORYCODE,NULL,NULL,NULL,NULL,POL.STARTDATE,POL.ENDDATE,VAT.VATAMOUNT,POL.NGI_FEES,
VAT.ADDITIONDATE,VAT.DELETIONDATE,VAT.VATAMOUNT,VAT.REFUNDVATAMOUNT FROM IM_POLICYFINANCE_VAT1  VAT
JOIN IM_NGI_JVPOSTING JV ON JV.REF_CODE = VAT.POLICYFINANCEPOSTINGCODE -- AND Nvl(JV.GROUPCODE,VAT.GROUPCODE) = VAT.GROUPCODE AND Nvl(JV.SESSIONPROCESSDONE,77) = Nvl(VAT.RELATIONNAME,77)
LEFT JOIN IM_MEMBERPOLICY MEMP ON MEMP.MEMBERPOLICYCODE = VAT.MEMBERPOLICYCODE   
LEFT JOIN IM_INDIVIDUALPOLICY POL ON POL.INDIVIDUALPOLICYCODE = JV.POLICYCODE
LEFT JOIN GENCONSTANT G ON G.CATEGORY='NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND Upper(G.LANGUAGECODE) = 'EN-US'
WHERE  To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND POLICYFINANCEPOSTINGCODE IN(SELECT REF_CODE FROM (SELECT Sum(Decode(MEMOTYPE,0,Abs(AMOUNT),Abs(AMOUNT)*-1)) AMOUNT,REF_CODE FROM IM_NGI_JVPOSTING WHERE To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND REF_CODE IS NOT NULL AND JVPREMIUMTYPE = 0 GROUP BY REF_CODE) WHERE AMOUNT <> 0 )
AND JV.POLICYTYPE = 1 AND Nvl(JV.BENEFITCODE,1) = 1 AND Nvl(JV.JVPREMIUMTYPE,0) = 0  AND JV.MEMOTYPE = 1
AND JV.REF_NO NOT IN(SELECT ENDORESMENTID FROM IM_EFORM_UW_HDR_TEM)  AND ADDITIONAMOUNT <> 0 ;

                                                                                              




INSERT INTO IM_PREMIUM_ACTUARY1 SELECT JV.REF_NO,JV.REFDATE,MEMP.ACARDID,MEMP.AMEMBERNAME,To_Char(MEMP.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
MEMP.APOLICYID,MEMP.APOLICYNAME,To_Char(MEMP.MEMBERSTARTDATE,'DD/MM/RRRR') MEMBERSTARTDATE,
To_Char(MEMP.MEMBERENDDATE,'DD/MM/RRRR') MEMBERENDDATE,G.CONSTANTNAME,VAT.ADDITIONAMOUNT,VAT.DELETIONAMOUNT,To_Char(POL.STARTDATE,'RRRR') UWYEAR,
POL.NGI_FEES,JV.AMOUNT,VAT.POLICYFINANCEPOSTINGCODE,VAT.MEMBERPOLICYCODE,2 POLICYTYPE,POL.INDIVIDUALPOLICYCODE,
MEMP.CATEGORYCODE,NULL,NULL,NULL,NULL,POL.STARTDATE,POL.ENDDATE,VAT.REFUNDVATAMOUNT*-1,POL.NGI_FEES,
VAT.ADDITIONDATE,VAT.DELETIONDATE,VAT.VATAMOUNT,VAT.REFUNDVATAMOUNT FROM IM_POLICYFINANCE_VAT1  VAT
JOIN IM_NGI_JVPOSTING JV ON JV.REF_CODE = VAT.POLICYFINANCEPOSTINGCODE -- AND Nvl(JV.GROUPCODE,VAT.GROUPCODE) = VAT.GROUPCODE AND Nvl(JV.SESSIONPROCESSDONE,77) = Nvl(VAT.RELATIONNAME,77)
LEFT JOIN IM_MEMBERPOLICY MEMP ON MEMP.MEMBERPOLICYCODE = VAT.MEMBERPOLICYCODE   
LEFT JOIN IM_INDIVIDUALPOLICY POL ON POL.INDIVIDUALPOLICYCODE = JV.POLICYCODE
LEFT JOIN GENCONSTANT G ON G.CATEGORY='NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND Upper(G.LANGUAGECODE) = 'EN-US'
WHERE  To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND POLICYFINANCEPOSTINGCODE IN(SELECT REF_CODE FROM (SELECT Sum(Decode(MEMOTYPE,0,Abs(AMOUNT),Abs(AMOUNT)*-1)) AMOUNT,REF_CODE FROM IM_NGI_JVPOSTING WHERE To_Date(REFDATE,'DD/MM/RRRR') BETWEEN
To_Date('01/03/2019','DD/MM/RRRR')  AND  To_Date('31/03/2019','DD/MM/RRRR')  
AND REF_CODE IS NOT NULL AND JVPREMIUMTYPE = 0 GROUP BY REF_CODE) WHERE AMOUNT <> 0 )
AND JV.POLICYTYPE = 1 AND Nvl(JV.BENEFITCODE,1) = 1 AND Nvl(JV.JVPREMIUMTYPE,0) = 0  AND JV.MEMOTYPE = 0
AND JV.REF_NO NOT IN(SELECT ENDORESMENTID FROM IM_EFORM_UW_HDR_TEM)  AND DELETIONAMOUNT <> 0 ;


                                                                           

 














     
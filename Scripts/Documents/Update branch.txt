BEGIN
FOR HDR IN(SELECT SHORT_NAME,CLAIMLINE FROM IM_EFORM_CLAIMS_HDR A,IM_POLICY P,HR_ORGANIZATIONS_D HR WHERE TO_DATE(PAYMENTDATE,'DD/MM/RRRR')
BETWEEN TO_DATE('01/05/2019','DD/MM/RRRR') AND TO_DATE('31/05/2019','DD/MM/RRRR')
AND A.POLICYCODE = P.POLICYCODE AND UPPER(A.POLICYTYPE)='GROUP'  AND P.BRANCHCODE = HR.ORGANIZATIONS_CODE) LOOP
UPDATE IM_EFORM_CLAIMS_HDR SET MAINBRANCH = HDR.SHORT_NAME,SUBBRANCH = HDR.SHORT_NAME,FURTHERBRANCH = HDR.SHORT_NAME
WHERE CLAIMLINE = HDR.CLAIMLINE;
COMMIT;
END LOOP;
END;

BEGIN
FOR HDR IN(SELECT SHORT_NAME,CLAIMLINE FROM IM_EFORM_CLAIMS_HDR A,IM_INDIVIDUALPOLICY P,HR_ORGANIZATIONS_D HR WHERE TO_DATE(PAYMENTDATE,'DD/MM/RRRR')
BETWEEN TO_DATE('01/05/2019','DD/MM/RRRR') AND TO_DATE('31/05/2019','DD/MM/RRRR')
AND A.POLICYCODE = P.INDIVIDUALPOLICYCODE AND UPPER(A.POLICYTYPE)='INDIVIDUAL'  AND P.BRANCHCODE = HR.ORGANIZATIONS_CODE) LOOP
UPDATE IM_EFORM_CLAIMS_HDR SET MAINBRANCH = HDR.SHORT_NAME,SUBBRANCH = HDR.SHORT_NAME,FURTHERBRANCH = HDR.SHORT_NAME
WHERE CLAIMLINE = HDR.CLAIMLINE;
COMMIT;
END LOOP;
END;

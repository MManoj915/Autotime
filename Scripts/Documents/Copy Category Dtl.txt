DECLARE L_POLCATESETTLMITAGECODE NUMBER;
L_POLCATSERIALNO NUMBER;
BEGIN
FOR HDR IN(  
SELECT * FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE = 100000000000026406  AND CATEGORYCODE IN
(SELECT CATEGORY_CODE FROM  IM_CATEGORIES WHERE CATEGORY_ID IN
('C-DXB' , 'D-DXB' , 'VIP-NE', 'A-NE', 'B-NE', 'C-NE', 'D-NE'))
) LOOP
INSERT INTO CAPPS.IM_POLICYCOVEREDNETWORK
(PCNCODE, 
PCDCODE, NETWORKCODE, COMPANYCODE, CREATEDBY, LASTMODIFIEDBY, 
CREATEDON, LASTMODIFIEDON, LOCATIONCODE, SERIALNO, ACTIVE, 
APPLICABLEFORCODE)
VALUES
((SELECT Max(PCNCODE)+1 FROM IM_POLICYCOVEREDNETWORK), HDR.PCDCODE, 1000000000000000029, 1, 100000000000000289, 
NULL, TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, 1, (SELECT MAX(SERIALNO)+1 FROM IM_POLICYCOVEREDNETWORK), 
1, 4);
COMMIT;     

INSERT INTO CAPPS.IM_PEGEOGRAFICAREA
(PEGACODE, 
PCDCODE, GACODE, COMPANYCODE, CREATEDBY, LASTMODIFIEDBY, 
CREATEDON, LASTMODIFIEDON, LOCATIONCODE, SERIALNO, ACTIVE)
VALUES
((SELECT MAX(PEGACODE)+1 FROM IM_PEGEOGRAFICAREA), HDR.PCDCODE, 5, 1, 100000000000000289, 
NULL, TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, 1, (SELECT MAX(SERIALNO)+1 FROM IM_PEGEOGRAFICAREA), 
1);
COMMIT;   

INSERT INTO CAPPS.IM_POLICYBEBEFITS
(POLICYBEBEFITSCODE, 
PCDCODE, BENEFIT_CODE, TYPECODE, ACTIVE, COMPANYCODE, 
CREATEDBY, LASTMODIFIEDBY, CREATEDON, LASTMODIFIEDON, LOCATIONCODE, 
SERIALNO, BENEFIT_TYPE, DEFAULTPREMIUM, APPLYSETTINGPREMIUM, APPLYFULLPERMIUMREFUND, 
CARDTEXT)
VALUES
((SELECT Max(POLICYBEBEFITSCODE)+1 FROM IM_POLICYBEBEFITS), HDR.PCDCODE, 10000000000000054, NULL, 1, 
1, 100000000000000289, NULL, TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, 
1, (SELECT MAX(SERIALNO)+1 FROM IM_POLICYBEBEFITS), NULL, NULL, 1, 
1, NULL);
COMMIT;


FOR DTL IN(SELECT * FROM  IM_POLCATESETTINGAGELIMITS WHERE PCDCODE=100000000000025185)LOOP
SELECT MAX(POLCATESETTLMITAGECODE)+1,MAX(SERIALNO)+1 INTO L_POLCATESETTLMITAGECODE,L_POLCATSERIALNO FROM IM_POLCATESETTINGAGELIMITS;
INSERT INTO CAPPS.IM_POLCATESETTINGAGELIMITS
(POLCATESETTLMITAGECODE, 
PCDCODE, AGEFROM, AGETO, GENDERCODE, PREMIUM, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
COMPANYCODE, LOCATIONCODE, DEACTIVATEDON, DEACTIVATEDBY, SERIALNO, 
APPLICABLEFOR, RENEWALTYPE, RENEWALVALUE, CARDTEXT, ISRESIZE)
VALUES
(L_POLCATESETTLMITAGECODE,HDR.PCDCODE, DTL.AGEFROM, DTL.AGETO, DTL.GENDERCODE, 
DTL.PREMIUM, NULL, TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000289, NULL, 
NULL, 1, 1, NULL, NULL, 
L_POLCATSERIALNO, DTL.APPLICABLEFOR, NULL, NULL, NULL, 
1);
COMMIT;

            
    FOR SDTL IN(SELECT * FROM  IM_POLCATEGORYAGERELATION WHERE POLCATESETTLMITAGECODE=DTL.POLCATESETTLMITAGECODE) LOOP
      INSERT INTO CAPPS.IM_POLCATEGORYAGERELATION
      (RELATIONCODE, 
      POLCATESETTLMITAGECODE, RELATIONTYPECODE, PREMIUM, CREATEDIN, CREATEDON, 
      CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, COMPANYCODE, LOCATIONCODE, 
      DEACTIVATEDON, DEACTIVATEDBY, SERIALNO, ISAPPLICABLE, RENEWALTYPE, 
      RENEWALVALUE)
      VALUES
      ((SELECT Max(RELATIONCODE)+1 FROM IM_POLCATEGORYAGERELATION), L_POLCATESETTLMITAGECODE, SDTL.RELATIONTYPECODE, SDTL.PREMIUM, NULL, 
      TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000289, NULL, NULL, 1, 
      1, NULL, NULL, (SELECT MAX(SERIALNO)+1 FROM IM_POLCATEGORYAGERELATION), 1, 
      NULL, NULL);  
      COMMIT;
    END LOOP;

END LOOP;
END LOOP;
END;


DECLARE L_BENSETTINGCODE NUMBER;L_SERIALNO NUMBER;
BEGIN
FOR HDR IN(SELECT * FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE = 100000000000026406  AND CATEGORYCODE IN
(SELECT CATEGORY_CODE FROM  IM_CATEGORIES WHERE CATEGORY_ID IN
('C-DXB' , 'D-DXB' , 'VIP-NE', 'A-NE', 'B-NE', 'C-NE', 'D-NE')))LOOP

FOR DTL IN( SELECT Max(BENEFITSETTINGCODE)  BENEFITSETTINGCODE  FROM IM_POLICY_BENEFITSETTING WHERE
      POLICYCODE = HDR.POLICYCODE AND CATEGORYCODE = HDR.CATEGORYCODE AND BENEFITCODE = 10000000000000054
	    AND REQTYPE = 0) LOOP
SELECT Max(BENSETTLMITAGECODE)+1,Max(SERIALNO)+1 INTO L_BENSETTINGCODE,L_SERIALNO FROM IM_BENSETTINGAGELIMITS;
INSERT INTO CAPPS.IM_BENSETTINGAGELIMITS
(BENSETTLMITAGECODE, 
BENEFITSETTINGCODE, AGEFROM, AGETO, GENDERCODE, PREMIUM, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
COMPANYCODE, LOCATIONCODE, DEACTIVATEDON, DEACTIVATEDBY, SERIALNO, 
APPLICABLEFOR)
VALUES
(L_BENSETTINGCODE, DTL.BENEFITSETTINGCODE, 0, 80, 2, 
15, NULL, TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000289, NULL, 
NULL, 1, 1, NULL, NULL, 
L_SERIALNO, 4);
COMMIT;   
           
INSERT INTO CAPPS.IM_BENSETTAGERELATION
(RELATIONCODE, 
BENSETTLMITAGECODE, RELATIONTYPECODE, PREMIUM, CREATEDIN, CREATEDON, 
CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, COMPANYCODE, LOCATIONCODE, 
DEACTIVATEDON, DEACTIVATEDBY, SERIALNO, ISAPPLICABLE)
VALUES
((SELECT MAX(RELATIONCODE)+1 FROM IM_BENSETTAGERELATION), L_BENSETTINGCODE, 9, 15, NULL, 
TO_DATE('06/09/2019 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000289, NULL, NULL, 1, 
1, NULL, NULL, (SELECT MAX(SERIALNO)+1 FROM IM_BENSETTAGERELATION), 1);
COMMIT;
END LOOP;
END LOOP;
END;

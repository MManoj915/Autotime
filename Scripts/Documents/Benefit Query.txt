SELECT POLICYTYPE,POLICYID,POLICYNAME,STARTDATE,ENDDATE,CATEGORY_ID,BENEFIT_ID,BENEFIT_NAME,LIMIT BENEFITLIMIT,PARENTBENEFIT,LIMIT1 PARENTLIMIT
FROM(SELECT 'Group' POLICYTYPE,POL.POLICYID,POL.POLICYNAME,POL.STARTDATE,POL.ENDDATE,IMC.CATEGORY_ID,BEN.BENEFIT_ID,BEN.BENEFIT_NAME,
(SELECT Max(LIMITS) FROM IM_POLICY_BENEFITSETTING  IMBS WHERE IMBS.POLICYCODE = POL.POLICYCODE
AND IMBS.CATEGORYCODE = PDTL.CATEGORYCODE AND IMBS.BENEFITCODE = QRBEN.BENEFIT_CODE AND IMBS.REQTYPE = 0) LIMIT,
(SELECT  BEN1.BENEFIT_ID  FROM IIM_BENEFIT_CODES_DET SUBDET 
LEFT JOIN IM_BENEFIT_CODES BEN1 ON BEN1.BENEFIT_CODE=SUBDET.BENEFIT_CODE 
WHERE SUBDET.SUB_BENEFIT_CODE= QRBEN.BENEFIT_CODE AND ROWNUM=1) PARENTBENEFIT,
(SELECT Max(LIMITS) FROM IM_POLICY_BENEFITSETTING  IMBS WHERE IMBS.POLICYCODE = POL.POLICYCODE
AND IMBS.CATEGORYCODE = PDTL.CATEGORYCODE AND IMBS.BENEFITCODE =  
(SELECT  BEN1.BENEFIT_CODE   FROM IIM_BENEFIT_CODES_DET SUBDET 
LEFT JOIN IM_BENEFIT_CODES BEN1 ON BEN1.BENEFIT_CODE=SUBDET.BENEFIT_CODE 
WHERE SUBDET.SUB_BENEFIT_CODE= QRBEN.BENEFIT_CODE AND ROWNUM=1)  AND IMBS.REQTYPE = 0) LIMIT1
FROM IM_POLICY POL
JOIN IM_POLICY_CATEGORYDTL PDTL ON PDTL.POLICYCODE = POL.POLICYCODE
JOIN IM_CATEGORIES IMC ON IMC.CATEGORY_CODE = PDTL.CATEGORYCODE
JOIN IM_POLICYBEBEFITS QRBEN ON  QRBEN.PCDCODE = PDTL.PCDCODE
JOIN IM_BENEFIT_CODES BEN ON BEN.BENEFIT_CODE=QRBEN.BENEFIT_CODE       
UNION ALL
SELECT  'Individual' POLICYTYPE,POL.POLICYID,POL.POLICYNAME,POL.STARTDATE,POL.ENDDATE,IMC.CATEGORY_ID,BEN.BENEFIT_ID,BEN.BENEFIT_NAME,
(SELECT Max(LIMITS) FROM IM_POLICY_BENEFITSETTING  IMBS WHERE IMBS.POLICYCODE = POL.INDIVIDUALPOLICYCODE
AND IMBS.CATEGORYCODE = PDTL.POLICYCATEGORYCODE AND IMBS.BENEFITCODE = QRBEN.BENEFIT_CODE AND IMBS.REQTYPE = 1) LIMIT,
(SELECT  BEN1.BENEFIT_ID  FROM IIM_BENEFIT_CODES_DET SUBDET 
LEFT JOIN IM_BENEFIT_CODES BEN1 ON BEN1.BENEFIT_CODE=SUBDET.BENEFIT_CODE 
WHERE SUBDET.SUB_BENEFIT_CODE= QRBEN.BENEFIT_CODE AND ROWNUM=1) PARENTBENEFIT,
(SELECT Max(LIMITS) FROM IM_POLICY_BENEFITSETTING  IMBS WHERE IMBS.POLICYCODE = POL.INDIVIDUALPOLICYCODE
AND IMBS.CATEGORYCODE = PDTL.POLICYCATEGORYCODE AND IMBS.BENEFITCODE =  
(SELECT  BEN1.BENEFIT_CODE   FROM IIM_BENEFIT_CODES_DET SUBDET 
LEFT JOIN IM_BENEFIT_CODES BEN1 ON BEN1.BENEFIT_CODE=SUBDET.BENEFIT_CODE 
WHERE SUBDET.SUB_BENEFIT_CODE= QRBEN.BENEFIT_CODE AND ROWNUM=1)  AND IMBS.REQTYPE = 1) LIMIT1
FROM IM_INDIVIDUALPOLICY POL
JOIN IM_NGIINDPOLICYCATEGORY PDTL ON PDTL.INDIVIDUALPOLICYCODE = POL.INDIVIDUALPOLICYCODE
JOIN IM_CATEGORIES IMC ON IMC.CATEGORY_CODE = PDTL.POLICYCATEGORYCODE
JOIN IM_INDIVIDUALPOLICYBEBEFITS QRBEN ON  QRBEN.POLICYCATEGORYCODE = PDTL.POLICYCATEGORYCODE
JOIN IM_BENEFIT_CODES BEN ON BEN.BENEFIT_CODE=QRBEN.BENEFIT_CODE  )
DECLARE L_MEMBERCOUNT NUMBER;
L_CANPREMIUM NUMBER(19,2);L_HEPPREMIUM NUMBER(19,2);
L_TOTAL NUMBER(19,2);L_LIFEPREMIUM NUMBER(19,2);
L_IPPREMIUM NUMBER(19,2);L_OPPREMIUM NUMBER(19,2);
BEGIN

-- Addition
FOR HDR IN(SELECT DISTINCT JV.* FROM IM_FINANCE_LINK_POSTING POS,IM_NGI_JVPOSTING JV
WHERE To_Date(DOCDATE,'DD/MM/RRRR') BETWEEN To_Date('01/05/2019','DD/MM/RRRR')
AND To_Date('31/05/2019','DD/MM/RRRR')  AND POS.DOCNO = JV.REF_NO  AND POS.DOC_TYPE='PRM'
AND JV.MEMOTYPE = 1 AND REVERSEJVCODE IS NULL  
) LOOP

  IF HDR.POLICYTYPE = 0 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND GROUPCODE = Nvl(HDR.GROUPCODE,GROUPCODE)
    AND Nvl(HDR.SESSIONPROCESSDONE,Nvl(RELATIONNAME,77)) = Nvl(RELATIONNAME,77) AND ADDITIONAMOUNT <> 0) LOOP 
      SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
      SELECT Sum(Abs(ADDPREMIUM)) INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498); 

       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
          LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'  
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;

   IF HDR.POLICYTYPE = 1 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND ADDITIONAMOUNT <> 0) LOOP 
       SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
       SELECT Sum(Abs(ADDPREMIUM)) INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
       SELECT Sum(Abs(ADDPREMIUM))  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
       SELECT Sum(Abs(ADDPREMIUM))  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
        SELECT Sum(Abs(ADDPREMIUM))  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(ADDPREMIUM))  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048;   
       SELECT Sum(Abs(ADDPREMIUM))  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498);
       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'      
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'    
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;  

END LOOP;

-- Deletion
FOR HDR IN(SELECT DISTINCT JV.* FROM IM_FINANCE_LINK_POSTING POS,IM_NGI_JVPOSTING JV
WHERE To_Date(DOCDATE,'DD/MM/RRRR') BETWEEN To_Date('01/05/2019','DD/MM/RRRR')
AND To_Date('31/05/2019','DD/MM/RRRR')  AND POS.DOCNO = JV.REF_NO  AND POS.DOC_TYPE='PRM'
AND JV.MEMOTYPE = 0 AND REVERSEJVCODE IS NULL  
) LOOP

    IF HDR.POLICYTYPE = 0 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND GROUPCODE = Nvl(HDR.GROUPCODE,GROUPCODE)
    AND Nvl(HDR.SESSIONPROCESSDONE,Nvl(RELATIONNAME,77)) = Nvl(RELATIONNAME,77) AND DELETIONAMOUNT <> 0) LOOP 
      SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
      SELECT Sum(Abs(REFUNDPREMIUM))*-1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
      SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
      SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
       SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
      SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498); 

       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
          LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'  
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;

   IF HDR.POLICYTYPE = 1 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND DELETIONAMOUNT <> 0) LOOP 
       SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
       SELECT Sum(Abs(REFUNDPREMIUM))*-1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
       SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
       SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
       SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
       SELECT Sum(Abs(REFUNDPREMIUM))*-1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498);
       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'      
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'    
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;


END LOOP;

--Addition Reversal
FOR HDR IN(SELECT DISTINCT JV.* FROM IM_FINANCE_LINK_POSTING POS,IM_NGI_JVPOSTING JV
WHERE To_Date(DOCDATE,'DD/MM/RRRR') BETWEEN To_Date('01/05/2019','DD/MM/RRRR')
AND To_Date('31/05/2019','DD/MM/RRRR')  AND POS.DOCNO = JV.REF_NO  AND POS.DOC_TYPE='PRM'
AND JV.MEMOTYPE = 0 AND REVERSEJVCODE IS NOT NULL  
) LOOP

  IF HDR.POLICYTYPE = 0 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND GROUPCODE = Nvl(HDR.GROUPCODE,GROUPCODE)
    AND Nvl(HDR.SESSIONPROCESSDONE,Nvl(RELATIONNAME,77)) = Nvl(RELATIONNAME,77) AND ADDITIONAMOUNT <> 0) LOOP 
      SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
      SELECT Sum(Abs(ADDPREMIUM))*-1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497;
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048;  
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498); 

       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
          LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'  
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;

   IF HDR.POLICYTYPE = 1 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND ADDITIONAMOUNT <> 0) LOOP 
       SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
       SELECT Sum(Abs(ADDPREMIUM))*-1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
       SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
       SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
       SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
       SELECT Sum(Abs(ADDPREMIUM))*-1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498);
       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'      
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,L_TOTAL ADDITIONAMOUNT,0 REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'    
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;


END LOOP;

--Deletion Reversal
FOR HDR IN(SELECT DISTINCT JV.* FROM IM_FINANCE_LINK_POSTING POS,IM_NGI_JVPOSTING JV
WHERE To_Date(DOCDATE,'DD/MM/RRRR') BETWEEN To_Date('01/05/2019','DD/MM/RRRR')
AND To_Date('31/05/2019','DD/MM/RRRR')  AND POS.DOCNO = JV.REF_NO  AND POS.DOC_TYPE='PRM'
AND JV.MEMOTYPE = 1 AND REVERSEJVCODE IS NOT NULL   
) LOOP

   IF HDR.POLICYTYPE = 0 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND GROUPCODE = Nvl(HDR.GROUPCODE,GROUPCODE)
    AND Nvl(HDR.SESSIONPROCESSDONE,Nvl(RELATIONNAME,77)) = Nvl(RELATIONNAME,77) AND DELETIONAMOUNT <> 0) LOOP 
      SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
      SELECT Sum(Abs(REFUNDPREMIUM))*1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
      SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
      SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
      SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
      SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
      SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
      AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498); 

       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
          LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'  
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;

   IF HDR.POLICYTYPE = 1 THEN
    FOR DTL IN(SELECT * FROM IM_POLICYFINANCE_VAT  WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE AND DELETIONAMOUNT <> 0) LOOP 
       SELECT Count(*) INTO L_MEMBERCOUNT FROM IM_MEMBERPOLICY WHERE MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
       SELECT Sum(Abs(REFUNDPREMIUM))*1 INTO L_CANPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001499; 
       SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_HEPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001498; 
       SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_LIFEPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 100000000000001497; 
       SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_IPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000017; 
       SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_OPPREMIUM FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) = 10000000000000048; 
       SELECT Sum(Abs(REFUNDPREMIUM))*1  INTO L_TOTAL FROM IM_POLICYFINANCEPOSTING_SDOC WHERE POLICYFINANCEPOSTINGCODE=HDR.REF_CODE
       AND MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE AND  Nvl(BENEFITCODE,0) NOT IN(100000000000001499,100000000000001498);
       IF L_MEMBERCOUNT > 0 THEN
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'      
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       ELSE
          INSERT INTO IM_PREMIUM_ACTUARY_2019
          SELECT HDR.REF_NO,HDR.REFDATE,MPOL.ACARDID,MPOL.AMEMBERNAME,To_Char(MPOL.MEMBERSTARTDATE,'RRRR') ISSUEDYEAR,
          MPOL.APOLICYID,MPOL.APOLICYNAME,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') INCEPTIONDATE,
          To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE),'DD/MM/RRRR') EXPIRYDATE,NULL MANAGEDBY,0 ADDITIONAMOUNT,L_TOTAL REFUNDVATAMOUNT,
          To_Char(MPOL.POLICYSTARTDDATE,'RRRR') UWYEAR,0 NGIFEE,L_TOTAL,
          HDR.REF_CODE,DTL.MEMBERPOLICYCODE,Decode(HDR.POLICYTYPE,0,1,1,2) ANNUALPOLICYTYPE,HDR.POLICYCODE,
          MPOL.CATEGORYCODE,G.CONSTANTNAME NATIONALITY,G1.CONSTANTNAME GENDER,G2.CONSTANTNAME RELATION,To_Char(MPOL.ADATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
          To_Char(MPOL.POLICYSTARTDDATE,'DD/MM/RRRR') POLICYSTARTDATE,To_Char(MPOL.POLICYENDDDATE,'DD/MM/RRRR') POLICYENDDATE,
          L_TOTAL,0 NGI_FEES,To_Date(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
          To_Date(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,DTL.VATAMOUNT,DTL.REFUNDVATAMOUNT,L_CANPREMIUM,L_HEPPREMIUM,L_LIFEPREMIUM,L_IPPREMIUM,L_OPPREMIUM FROM IM_MEMBERPOLICY_POSTING MPOL
           LEFT JOIN GENCONSTANT G ON G.CATEGORY = 'FND_NATIONALITY' AND G.CONSTANTVALUE = MPOL.A_NATIONALITY AND Upper(G.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G1 ON G1.CATEGORY = 'GENDER' AND G1.CONSTANTVALUE = MPOL.AGENDER AND Upper(G1.LANGUAGECODE) = 'EN-US'
          LEFT JOIN GENCONSTANT G2 ON G2.CATEGORY = 'MEMBERRELATION' AND G2.CONSTANTVALUE = MPOL.ARELATION AND Upper(G2.LANGUAGECODE) = 'EN-US'    
          WHERE MPOL.MEMBERPOLICYCODE = DTL.MEMBERPOLICYCODE;
          COMMIT;
       END IF; 
    END LOOP;
  END IF;



END LOOP;

END;
                                            
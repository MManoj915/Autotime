INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.*,0 NGIFEE FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,Sum(IPPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100) TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,0 COMMISSION,DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES 
FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE (IPPREMIUM+OPPREMIUM) <> 0 AND  To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 1     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;               


INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.*,0 NGIFEE FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,Sum(OPPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100) TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,0 COMMISSION,DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES 
FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE (IPPREMIUM+OPPREMIUM) <> 0 AND  To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 2     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;    


INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.*  FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,(Sum(A.AGENTCOM+A.TPAFEE+A.ADMINFEE+A.NGI_FEES)*(TDTL.FACULTATIVEPERCENTAGE/100))*-1 TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,Round((Sum(AGENTCOM+A.TPAFEE+ADMINFEE)*(TDTL.FACULTATIVEPERCENTAGE/100)),2) COMMISSION,
DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES,Round((Sum(A.NGI_FEES)*(TDTL.FACULTATIVEPERCENTAGE/100)),2) 
FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE (IPPREMIUM+OPPREMIUM) <> 0 AND  To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 3     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;     


INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.*  FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,(Sum(AGENTCOM+A.TPAFEE+A.ADMINFEE+A.NGI_FEES)*(TDTL.FACULTATIVEPERCENTAGE/100))*-1 TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,Round((Sum(AGENTCOM+A.TPAFEE+ADMINFEE)*(TDTL.FACULTATIVEPERCENTAGE/100)),2) COMMISSION,
DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES,Round((Sum(A.NGI_FEES)*(TDTL.FACULTATIVEPERCENTAGE/100)),2) 
FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE (IPPREMIUM+OPPREMIUM) <> 0 AND  To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4 AND A.POLICYNUMBER='9245-1'     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;              
           


INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.* FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,Sum(TOTALPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100) TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,Round((Sum(AGENTCOM+A.TPAFEE+ADMINFEE)*(TDTL.FACULTATIVEPERCENTAGE/100)),2) COMMISSION,
DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES,Sum(A.NGI_FEES) NGIFEE
 FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE (IPPREMIUM+OPPREMIUM) = 0 AND To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;   


            



INSERT INTO IM_RI_SESSION_UW_FMC
SELECT H.*,0 NGIFEE FROM(SELECT DISTINCT TRT.TREATYNAME,ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,
A.ACC_PIN,P.POLICYID,P.POLICYNAME,Sum(LIFEPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100) TOTALPREMIUM,0 CLAIMAMOUNT,A.UWYEAR,
Sum(TOTALPREMIUM) DOCUMENTAMOUNT,0 NETPREMIUM,0 COMMISSION,
DTL.FACULTATIVEPERCENTAGE TREATYPERCENTAGE,G.CONSTANTNAME,
A.MANAGEDBY,A.BRANCHNAME,P.STARTDATE,P.ENDDATE,P.NGI_FEES 
 FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2019','DD/MM/RRRR') AND To_Date('31/01/2019','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE   IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 7     --AND ENDORESMENTID='02181123561'
GROUP BY POLICYNUMBER,ENDORESMENTID,TRT.TREATYNAME,INS.INS_NAME,TDTL.FACULTATIVEPERCENTAGE,G.CONSTANTNAME,
TRT.CALCULATIONTYPE,SDTL.PREMIUMTYPE,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR'),A.ACC_PIN,P.POLICYID,P.POLICYNAME,A.UWYEAR,
A.MANAGEDBY,A.BRANCHNAME,DTL.FACULTATIVEPERCENTAGE,P.STARTDATE,P.ENDDATE,P.NGI_FEES )H ;
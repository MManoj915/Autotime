SELECT SUM(PREMIUM),SUM(COMMISSION),REF_CODE FROM(SELECT SUM(DECODE(MEMOTYPE,0,ABS(AMOUNT),ABS(AMOUNT)*-1)) PREMIUM,0 COMMISSION,REF_CODE FROM 
IM_NGI_JVPOSTING WHERE JVPREMIUMTYPE = 0 AND REF_CODE IN
(SELECT DISTINCT REF_CODE FROM IM_NGI_JVPOSTING
WHERE JVPREMIUMTYPE = 0 AND REF_CODE IN
(SELECT REF_CODE FROM IM_NGI_JVPOSTING 
WHERE REF_NO IN(SELECT * FROM IPOPJV) )) GROUP BY REF_CODE
UNION ALL
SELECT 0 PREMIUM,SUM(DECODE(MEMOTYPE,0,ABS(AMOUNT),ABS(AMOUNT)*-1)) COMMISSION,REF_CODE FROM IM_NGI_JVPOSTING WHERE 
JVPREMIUMTYPE <> 0 AND REF_CODE IN
(SELECT DISTINCT REF_CODE FROM IM_NGI_JVPOSTING
WHERE  REF_CODE IN
(SELECT REF_CODE FROM IM_NGI_JVPOSTING 
WHERE REF_NO IN(SELECT * FROM IPOPJV) )) GROUP BY REF_CODE) GROUP BY REF_CODE
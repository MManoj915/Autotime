Policy Finance Master :

Select pfp.*,Gen12.ConstantName AdministeredByName,GEN.CONSTANTNAME PolicyTypeName,pol.POLICYID,
decode(POLICYTYPECODE,1,pol.POLICYNAME,2,Indpol.POLICYNAME) POLICYNAME,pol.StartDate,pol.ENDDATE,
bilgen.CONSTANTNAME OldBillingTypeName,  nvl(IG.GROUP_NAME,(mem.FIRST_NAME||' '||mem.LAST_NAME) ) GroupName,
(mem.FIRST_NAME||' '||mem.LAST_NAME) MemberName, age.AGENT_NAME_EN AgentName, Bro.BROKER_NAME_EN BrokerName, 
Indpol.POLICYID IPPolicyID,GEN1.CONSTANTNAME AuthorizedStatusName,Indpol.POLICYNAME IndividualPolicyName,
BRA.ORGANIZATION_NAME BranchName,decode(pfp.AUTHORIZEDSTATUS,1,to_date(pfp.LASTMODIFIEDON,'dd/MM/yyyy'),null) ApprovedDate,  
Prod.RefNo  BatchNo,Gen11.ConstantName ProductionSourceName from IM_POLICYFINANCEPOSTING pfp 
left join genconstant gen on GEN.CONSTANTVALUE=PFP.POLICYTYPECODE and GEN.CATEGORY='MEMBERPOLICYTYPE' and 
GEN.LANGUAGECODE='en-US' 
left join im_individualpolicy Indpol on Indpol.INDIVIDUALPOLICYCODE= pfp.INDIVIDUALPOLICYCODE 
left join im_policy pol on pol.POLICYCODE=pfp.POLICYCODE 
left join HR_ORGANIZATIONS_D bra on bra.ORGANIZATIONS_CODE=pfp.BranchCode        
left join genconstant gen1 on gen1.CONSTANTVALUE=pfp.AUTHORIZEDSTATUS and GEN1.CATEGORY='AUTHORIZEDSTATUS' and 
GEN1.LANGUAGECODE='en-US' 
left join genconstant bilgen on bilgen.CONSTANTVALUE=pfp.BILLINGTYPE and bilgen.CATEGORY='ENDORSEMENTBILLINGTYPE' and 
bilgen.LANGUAGECODE='en-US' 
left join im_Agents age on age.agentcode=decode(POLICYTYPECODE,1,pol.AGENTCODE,2,Indpol.AGENTCODE) 
left join im_Brokers Bro on Bro.BROKERCODE=decode(POLICYTYPECODE,1,pol.BROKERCODE,2,Indpol.BROKERCODE) 
left join IM_GROUPS ig on IG.GROUP_CODE=pol.GROUPCODE 
left join IM_MEMBERS mem on MEM.MEMBER_CODE=Indpol.MEMBERCODE 
left join GenConstant Gen12 on Gen12.Category='NGIQUOTATIONTYPE' and Gen12.ConstantValue = Nvl(Pol.OwnerCode,IndPol.OwnerCode)
 and Gen12.LanguageCode = 'en-US'  
 left join GenConstant Gen11 on Gen11.ConstantValue = PFP.ProductionSource and Gen11.Category = 'PRODUCTIONSOURCE' and 
 Gen11.LanguageCode = 'en-US' 
 left join IM_PRODUCTIONBATCH_VW Prod on Prod.ProductionCode = PFP.ProductionBatchCode and Prod.Source = PFP.ProductionSource  order by pfp.POLICYFINANCEPOSTINGCODE desc


Endoresment Detail :

SELECT  PFD.*,MEMP.ACARDID CARDID,NVL(MEMP.AMEMBERID,Nvl(MEM.MEMBER_ID,RMEM.MEMBER_ID)) MEMBER_ID,
Nvl((MEM.FIRST_NAME||''||MEM.LAST_NAME),(RMEM.FIRST_NAME||''||RMEM.LAST_NAME)) MEMBERNAME,
CAT.CATEGORY_NAME,NVL(MEM.PARENTGROUPCODE,MEM.GROUP_CODE) 
GROUPCODE FROM IM_POLICYFINANCEPOSTINGDTL PFD   
JOIN IM_MEMBERPOLICY MEMP ON MEMP.MEMBERPOLICYCODE=PFD.MEMBERPOLICYCODE  
JOIN IM_CORDPRINT  CAR ON CAR.MEMBERPOLICYCODE=MEMP.MEMBERPOLICYCODE   
LEFT JOIN IM_MEMBERS MEM ON MEM.MEMBER_CODE=MEMP.MEMBERCODE
LEFT JOIN IM_REINS_MEMBERS RMEM ON RMEM.MEMBER_CODE=MEMP.REINSMEMBERCODE   
LEFT JOIN IM_CATEGORIES  CAT ON CAT.CATEGORY_CODE=MEMP.CATEGORYCODE  
ORDER BY Nvl(NVL(MEM.PARENT_ID,MEM.MEMBER_CODE),NVL(RMEM.PARENT_ID,RMEM.MEMBER_CODE)),NVL2(MEM.PARENT_ID,0,1) DESC


Commission Detail :

SELECT PFPC.*,GEN.CONSTANTNAME COMISSIONTYPENAME FROM  IM_PFPCOMMISSIONDTL PFPC 
LEFT JOIN GENCONSTANT GEN ON GEN.CONSTANTVALUE=PFPC.COMISSION_TYPES AND GEN.CATEGORY='NGICOMMISSIONTYPE' AND 
GEN.LANGUAGECODE='EN-US' WHERE PFPC.POLICYFINANCEPOSTINGCODE=100000000000009865

Installment Detail :

SELECT IPI.*,CON.CONSTANTNAME CALCMETHODNAME FROM IM_POLICYFINANCE_INSTALLMENT IPI 
LEFT JOIN GENCONSTANT CON ON CON.CONSTANTVALUE = IPI.CALC_METHOD AND CON.CATEGORY = 'FINECALCULATIONTYPE' AND 
CON.LANGUAGECODE = 'EN-US' WHERE IPI.POLICYFINANCEPOSTINGCODE=100000000000009865


Please Call the below Functions:

fn_policyfinanceposting(PolicyType,PolicyCode,TPASource,TPAProductionCode);
FN_POLICYFINANCECOMMISION(PolicyType,PolicyCode,TPASource,TPAProductionCode);
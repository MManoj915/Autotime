SELECT Count(*),BRANCHNAME FROM(SELECT Nvl(Nvl(Nvl(Decode(POL.INDIPOLICYSOURCECODE,4,AGH.SHORT_NAME,5,BRH.SHORT_NAME,POLH.SHORT_NAME),AGH.SHORT_NAME),
BRH.SHORT_NAME),POLH.SHORT_NAME) BRANCHNAME  FROM IM_POLICYFINANCEPOSTING POS
JOIN IM_INDIVIDUALPOLICY POL ON POL.INDIVIDUALPOLICYCODE = POS.INDIVIDUALPOLICYCODE
LEFT JOIN GENCONSTANT GEN ON GEN.CATEGORY = 'SOURCE' AND GEN.LANGUAGECODE = 'en-US' AND GEN.CONSTANTVALUE = POL.INDIPOLICYSOURCECODE
LEFT JOIN IM_AGENTS AG ON AG.AGENTCODE =POL.AGENTCODE
LEFT JOIN IM_BROKERS BR ON BR.BROKERCODE = POL.BROKERCODE
LEFT JOIN HR_ORGANIZATIONS_D AGH ON AGH.ORGANIZATIONS_CODE = AG.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D BRH ON BRH.ORGANIZATIONS_CODE = BR.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D POLH ON POLH.ORGANIZATIONS_CODE = POL.BRANCHCODE
WHERE POS.POLICYFINANCEPOSTINGCODE IN
(SELECT REF_CODE FROM IM_NGI_JVPOSTING WHERE REF_CODE IS NOT NULL
AND To_Date(REFDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2017','DD/MM/RRRR') AND  To_Date('30/04/2017','DD/MM/RRRR')
AND REVERSEJVCODE IS NULL AND POLICYTYPECODE = 2))
WHERE BRANCHNAME IS NOT NULL GROUP BY BRANCHNAME

 

SELECT Count(*),BRANCHNAME FROM(SELECT Nvl(Nvl(Nvl(Decode(POL.REQUEST_SOURCE,4,AGH.SHORT_NAME,5,BRH.SHORT_NAME,POLH.SHORT_NAME),AGH.SHORT_NAME),
BRH.SHORT_NAME),POLH.SHORT_NAME) BRANCHNAME  FROM IM_POLICYFINANCEPOSTING POS
JOIN IM_POLICY POL ON POL.POLICYCODE = POS.POLICYCODE
LEFT JOIN GENCONSTANT GEN ON GEN.CATEGORY = 'SOURCE' AND GEN.LANGUAGECODE = 'en-US' AND GEN.CONSTANTVALUE = POL.REQUEST_SOURCE
LEFT JOIN IM_AGENTS AG ON AG.AGENTCODE =POL.AGENTCODE
LEFT JOIN IM_BROKERS BR ON BR.BROKERCODE = POL.BROKERCODE
LEFT JOIN HR_ORGANIZATIONS_D AGH ON AGH.ORGANIZATIONS_CODE = AG.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D BRH ON BRH.ORGANIZATIONS_CODE = BR.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D POLH ON POLH.ORGANIZATIONS_CODE = POL.BRANCHCODE
WHERE POS.POLICYFINANCEPOSTINGCODE IN
(SELECT REF_CODE FROM IM_NGI_JVPOSTING WHERE REF_CODE IS NOT NULL
AND To_Date(REFDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2017','DD/MM/RRRR') AND  To_Date('30/04/2017','DD/MM/RRRR')
AND REVERSEJVCODE IS NULL AND POLICYTYPECODE = 1))
WHERE BRANCHNAME IS NOT NULL GROUP BY BRANCHNAME


SELECT Count(*),BRANCHNAME FROM (SELECT POL.POLICYID,
Nvl(Nvl(Nvl(Decode(POL.REQUEST_SOURCE,4,AGH.SHORT_NAME,5,BRH.SHORT_NAME,POLH.SHORT_NAME),AGH.SHORT_NAME),
BRH.SHORT_NAME),POLH.SHORT_NAME)  
BRANCHNAME FROM IM_POLICY POL
LEFT JOIN GENCONSTANT GEN ON GEN.CATEGORY = 'SOURCE' AND GEN.LANGUAGECODE = 'en-US' AND GEN.CONSTANTVALUE = POL.REQUEST_SOURCE
LEFT JOIN IM_AGENTS AG ON AG.AGENTCODE =POL.AGENTCODE
LEFT JOIN IM_BROKERS BR ON BR.BROKERCODE = POL.BROKERCODE
LEFT JOIN HR_ORGANIZATIONS_D AGH ON AGH.ORGANIZATIONS_CODE = AG.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D BRH ON BRH.ORGANIZATIONS_CODE = BR.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D POLH ON POLH.ORGANIZATIONS_CODE = POL.BRANCHCODE
WHERE To_Date(POL.STARTDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2017','DD/MM/RRRR')
AND To_Date('30/04/2017','DD/MM/RRRR') AND POL.AUTHORIZEDSTATUS = 1
)WHERE BRANCHNAME IS NOT NULL GROUP BY BRANCHNAME 

                       



-- 3 DIR
--4 AG
-- 5 BR 


SELECT Count(*),BRANCHNAME FROM (SELECT POL.POLICYID,
Nvl(Nvl(Nvl(Decode(POL.INDIPOLICYSOURCECODE,4,AGH.SHORT_NAME,5,BRH.SHORT_NAME,POLH.SHORT_NAME),AGH.SHORT_NAME),
BRH.SHORT_NAME),POLH.SHORT_NAME)  
BRANCHNAME FROM IM_INDIVIDUALPOLICY POL
LEFT JOIN GENCONSTANT GEN ON GEN.CATEGORY = 'SOURCE' AND GEN.LANGUAGECODE = 'en-US' AND GEN.CONSTANTVALUE = POL.INDIPOLICYSOURCECODE
LEFT JOIN IM_AGENTS AG ON AG.AGENTCODE =POL.AGENTCODE
LEFT JOIN IM_BROKERS BR ON BR.BROKERCODE = POL.BROKERCODE
LEFT JOIN HR_ORGANIZATIONS_D AGH ON AGH.ORGANIZATIONS_CODE = AG.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D BRH ON BRH.ORGANIZATIONS_CODE = BR.BRANCHCODE
LEFT JOIN HR_ORGANIZATIONS_D POLH ON POLH.ORGANIZATIONS_CODE = POL.BRANCHCODE
WHERE To_Date(POL.STARTDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2017','DD/MM/RRRR')
AND To_Date('30/04/2017','DD/MM/RRRR') AND POL.AUTHORIZEDSTATUS = 1
)WHERE BRANCHNAME IS NOT NULL GROUP BY BRANCHNAME 

                       



-- 3 DIR
--4 AG
-- 5 BR 
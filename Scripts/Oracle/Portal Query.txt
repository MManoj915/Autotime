SELECT * FROM(
SELECT MEMBERID,Max(POLICYID),Max(POLICYNAME),Max(REF_NO),Max(AMOUNT),Max(STAFF),
SUM(NVL(A1,0)) A1,SUM(NVL(B1,0)) A2,SUM(NVL(A2,0)) B1,SUM(NVL(B2,0)) B2 FROM(SELECT 
POL.PORTALMEMBERID MEMBERID,POL.POLICYID,POL.POLICYNAME,JV.REF_NO,JV.AMOUNT,'' STAFF,
TO_CHAR(D.ACCOUNTNUMBER) A1,
TO_CHAR(D.PINCODE) B1,'' A2,'' B2 FROM IM_POLICYFINANCEPOSTING POS
JOIN IM_NGI_JVPOSTING JV ON JV.REF_CODE = POS.POLICYFINANCEPOSTINGCODE
JOIN IM_AGENTS_BILLING_DETAIL D ON D.AGENTCODE = JV.AGENTCODE 
JOIN IM_INDIVIDUALPOLICY POL ON POL.INDIVIDUALPOLICYCODE = POS.INDIVIDUALPOLICYCODE
WHERE POL.PORTALMEMBERID IS NOT NULL  AND JV.JVPREMIUMTYPE = 0
UNION ALL
SELECT POR2.MEMBERID,'' POLICYID,'' POLICYNAME,'' REF_NO,0 AMOUNT,To_Char(POR2.STAFF),
'' A1,'' B1,TO_CHAR(D.ACCOUNTNUMBER) A2,TO_CHAR(D.PINCODE) B2 FROM IM_PORTAL POR2
JOIN IM_TPABRANCH_DTL A ON UPPER(A.USERID) = UPPER(POR2.STAFF)
JOIN IM_AGENTS AG ON AG.AGENT_ID = A.AGENTCODE
JOIN IM_AGENTS_BILLING_DETAIL D ON D.AGENTCODE = AG.AGENTCODE
) GROUP BY MEMBERID ) WHERE (A1+A2) <> 0 AND (B1+B2) <> 0
 
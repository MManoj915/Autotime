TPA Upload :

Detail :

SELECT IMP.*,POL.POLICYID,POL.POLICYNAME,POL.STARTDATE,POL.ENDDATE,POL.BASE_PERIMUM,GROP.GROUP_NAME GROUPNAME,  
GEN3P.CONSTANTNAME SOURCETYPENAME,GENNP.CONSTANTNAME PERIMUMNAME,GENP.CONSTANTNAME ANNUALLIMITTYPENAME,POL.ALTLIMIT,
GEN1P.CONSTANTNAME INPATIENTNAME,  GEN2P.CONSTANTNAME OUTPATIENTNAME,POL.IPLIMIT,POL.OPLIMIT,
GEN.CONSTANTNAME AUTHORIZEDSTATUSNAME FROM IM_REINS_ADDMEMBERPOLICY IMP   
JOIN ADMCOMPANY ADMCOM ON ADMCOM.COMPANYCODE=IMP.COMPANYCODE AND ADMCOM.COMPANYCODE= 1 
JOIN (SELECT CONSTANTVALUE,CONSTANTNAME FROM GENCONSTANT WHERE CATEGORY='AUTHORIZEDSTATUS' AND LANGUAGECODE='en-US')GEN 
ON GEN.CONSTANTVALUE=IMP.AUTHORIZEDSTATUS LEFT JOIN IM_POLICY POL ON POL.POLICYCODE = IMP.POLICYCODE  
LEFT JOIN IM_CATEGORIES CATP ON CATP.CATEGORY_CODE=POL.CATEGORYCODE    
LEFT JOIN IM_GROUPS GROP ON GROP.GROUP_CODE =POL.GROUPCODE   
LEFT JOIN GENCONSTANT  GENNP ON GENNP.CONSTANTVALUE=POL.PERIMUMCODE AND GENNP.CATEGORY='PERIMUMS' AND 
GENNP.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GENP ON GENP.CONSTANTVALUE=POL.ANNUALLIMITTYPE AND GENP.CATEGORY='CALCMETHOD' AND 
GENP.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN1P ON GEN1P.CONSTANTVALUE=POL.INPATIENT AND GEN1P.CATEGORY='CALCMETHOD' AND 
GEN1P.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN3P ON GEN3P.CONSTANTVALUE=IMP.SOURCETYPE AND GEN3P.CATEGORY='REINSURERBATCHTYPE' AND 
GEN3P.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN2P ON GEN2P.CONSTANTVALUE=POL.OUTPATIENT AND  GEN2P.CATEGORY='CALCMETHOD' AND 
GEN2P.LANGUAGECODE='en-US'  WHERE IMP.SOURCETYPE = 1  AND IMP.TPAPRODHDRCODE=100000000000001761 
ORDER BY IMP.REINSADDMEMBERPOLICYCODE DESC


Sub Detail :

SELECT IQM.*,GEN.CONSTANTNAME AS GENDERNAME,GEN1.CONSTANTNAME MEMBERRELATIONNAME,GEN2.CONSTANTNAME MARITALSTATUSNAME,
GEN3.CONSTANTNAME AS NATIONALITYNAME,FLOOR(MONTHS_BETWEEN(SYSDATE,IQM.DATE_OF_BIRTH)/12) AS AGE,GC.CATEGORY_NAME CATEGORYNAME,
PARGRO.GROUP_NAME AS PARENTGROUPNAME FROM IM_REINSADDMEMBERDET IQM    
LEFT JOIN GENCONSTANT GEN ON GEN.CONSTANTVALUE=IQM.GENDERCODE  AND GEN.CATEGORY='GENDER' AND LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN1 ON GEN1.CONSTANTVALUE=IQM.MEMBERRELATIONCODE AND GEN1.CATEGORY='MEMBERRELATION' 
AND GEN1.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN2 ON GEN2.CONSTANTVALUE=IQM.MARITALSTATUSCODE AND GEN2.CATEGORY='MARITAL_STATUS' 
AND GEN2.LANGUAGECODE='en-US'   
LEFT JOIN GENCONSTANT GEN3 ON GEN3.CONSTANTVALUE=IQM.NATIONALITYCODE AND GEN3.CATEGORY='FND_NATIONALITY' AND 
GEN3.LANGUAGECODE='en-US'  
LEFT JOIN IM_CATEGORIES GC ON GC.CATEGORY_CODE=IQM.CATEGORYCODE 
LEFT JOIN IM_GROUPS PARGRO ON PARGRO.GROUP_CODE=IQM.PARENTGROUPCODE WHERE IQM.REINSADDMEMBERPOLICYCODE=100000000000012379 

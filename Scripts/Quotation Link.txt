DECLARE  L_FROMAGE NUMBER;L_TOAGE NUMBER;
L_RELATION NUMBER;L_MARITALSTATUS NUMBER;L_GENDER NUMBER;
BEGIN
FOR HDR IN(SELECT * FROM USER_TAB_COLUMNS  WHERE TABLE_NAME = 'IM_PR_QUOTATION'
AND COLUMN_NAME LIKE '%COLUMN%' ORDER BY COLUMN_ID) LOOP

L_RELATION := 0;
L_FROMAGE := 0;
L_TOAGE := 0;
L_GENDER := 0;
L_MARITALSTATUS := 0;
-- Age between 0 and 18
IF HDR.COLUMN_NAME = 'COLUMN1' OR HDR.COLUMN_NAME = 'COLUMN5' OR HDR.COLUMN_NAME = 'COLUMN9' OR HDR.COLUMN_NAME = 'COLUMN13'
OR HDR.COLUMN_NAME = 'COLUMN17' OR HDR.COLUMN_NAME = 'COLUMN21' OR HDR.COLUMN_NAME = 'COLUMN25' OR HDR.COLUMN_NAME = 'COLUMN29'
OR HDR.COLUMN_NAME = 'COLUMN33' OR HDR.COLUMN_NAME = 'COLUMN37' OR HDR.COLUMN_NAME = 'COLUMN41' OR HDR.COLUMN_NAME = 'COLUMN45' THEN
  L_FROMAGE := 0;
  L_TOAGE := 18;    
END IF; 

-- Age between 19 and 30
IF HDR.COLUMN_NAME = 'COLUMN2' OR HDR.COLUMN_NAME = 'COLUMN6' OR HDR.COLUMN_NAME = 'COLUMN10' OR HDR.COLUMN_NAME = 'COLUMN14'
OR HDR.COLUMN_NAME = 'COLUMN18' OR HDR.COLUMN_NAME = 'COLUMN22' OR HDR.COLUMN_NAME = 'COLUMN26' OR HDR.COLUMN_NAME = 'COLUMN30'
OR HDR.COLUMN_NAME = 'COLUMN34' OR HDR.COLUMN_NAME = 'COLUMN38' OR HDR.COLUMN_NAME = 'COLUMN42' OR HDR.COLUMN_NAME = 'COLUMN46'  THEN
  L_FROMAGE := 19;
  L_TOAGE := 30;   
END IF; 

-- Age between 31 and 50
IF HDR.COLUMN_NAME = 'COLUMN3' OR HDR.COLUMN_NAME = 'COLUMN7' OR HDR.COLUMN_NAME = 'COLUMN11' OR HDR.COLUMN_NAME = 'COLUMN15'
OR HDR.COLUMN_NAME = 'COLUMN19' OR HDR.COLUMN_NAME = 'COLUMN23' OR HDR.COLUMN_NAME = 'COLUMN27' OR HDR.COLUMN_NAME = 'COLUMN31'
OR HDR.COLUMN_NAME = 'COLUMN35' OR HDR.COLUMN_NAME = 'COLUMN39' OR HDR.COLUMN_NAME = 'COLUMN43' OR HDR.COLUMN_NAME = 'COLUMN47'
OR HDR.COLUMN_NAME = 'COLUMN49' OR HDR.COLUMN_NAME = 'COLUMN51'  THEN
  L_FROMAGE := 31;
  L_TOAGE := 50;    
END IF; 

-- Age between 51 and 90
IF HDR.COLUMN_NAME = 'COLUMN4' OR HDR.COLUMN_NAME = 'COLUMN8' OR HDR.COLUMN_NAME = 'COLUMN12' OR HDR.COLUMN_NAME = 'COLUMN16'
OR HDR.COLUMN_NAME = 'COLUMN20' OR HDR.COLUMN_NAME = 'COLUMN24' OR HDR.COLUMN_NAME = 'COLUMN28' OR HDR.COLUMN_NAME = 'COLUMN32'
OR HDR.COLUMN_NAME = 'COLUMN36' OR HDR.COLUMN_NAME = 'COLUMN40' OR HDR.COLUMN_NAME = 'COLUMN44' OR HDR.COLUMN_NAME = 'COLUMN48'
OR HDR.COLUMN_NAME = 'COLUMN50' OR HDR.COLUMN_NAME = 'COLUMN52'  THEN     
  L_FROMAGE := 51;
  L_TOAGE := 90;     
END IF; 

-- Single,Male,Employee
IF  HDR.COLUMN_NAME = 'COLUMN1' OR HDR.COLUMN_NAME = 'COLUMN2' OR HDR.COLUMN_NAME = 'COLUMN3' OR HDR.COLUMN_NAME = 'COLUMN4'  THEN
  L_RELATION := 77;
  L_MARITALSTATUS := 0;
  L_GENDER := 0;
END IF;

-- Married,Male,Employee
IF HDR.COLUMN_NAME = 'COLUMN5' OR HDR.COLUMN_NAME = 'COLUMN6' OR HDR.COLUMN_NAME = 'COLUMN7' OR HDR.COLUMN_NAME = 'COLUMN8' THEN
  L_RELATION := 77;
  L_MARITALSTATUS := 1;
  L_GENDER := 0;    
END IF;

-- Single,Female,Employee
IF HDR.COLUMN_NAME = 'COLUMN9' OR HDR.COLUMN_NAME = 'COLUMN10' OR HDR.COLUMN_NAME = 'COLUMN11' OR HDR.COLUMN_NAME = 'COLUMN12'  THEN
  L_RELATION := 77;
  L_MARITALSTATUS := 0;
  L_GENDER := 1;
END IF;

-- Married,Female,Employee
IF  HDR.COLUMN_NAME = 'COLUMN13' OR HDR.COLUMN_NAME = 'COLUMN14' OR HDR.COLUMN_NAME = 'COLUMN15' OR HDR.COLUMN_NAME = 'COLUMN16' THEN
  L_RELATION := 77;
  L_MARITALSTATUS := 1;
  L_GENDER := 1;
END IF;

-- Single,Male,Husband
IF  HDR.COLUMN_NAME = 'COLUMN17' OR HDR.COLUMN_NAME = 'COLUMN18' OR HDR.COLUMN_NAME = 'COLUMN19' OR HDR.COLUMN_NAME = 'COLUMN20' THEN
  L_RELATION := 4;
  L_MARITALSTATUS := 0;
  L_GENDER := 0;
END IF;

-- Married,Male,Husband
IF HDR.COLUMN_NAME = 'COLUMN21' OR HDR.COLUMN_NAME = 'COLUMN22' OR HDR.COLUMN_NAME = 'COLUMN23' OR HDR.COLUMN_NAME = 'COLUMN24' THEN
  L_RELATION := 4;
  L_MARITALSTATUS := 1;
  L_GENDER := 0;     
END IF;

-- Single,Female,Wife
IF HDR.COLUMN_NAME = 'COLUMN25' OR HDR.COLUMN_NAME = 'COLUMN26' OR HDR.COLUMN_NAME = 'COLUMN27' OR HDR.COLUMN_NAME = 'COLUMN28' THEN
  L_RELATION := 8;
  L_MARITALSTATUS := 0;
  L_GENDER := 1;  
END IF;

-- Married,Female,Wife
IF HDR.COLUMN_NAME = 'COLUMN29' OR HDR.COLUMN_NAME = 'COLUMN30' OR HDR.COLUMN_NAME = 'COLUMN31' OR HDR.COLUMN_NAME = 'COLUMN32' THEN
  L_RELATION := 8;
  L_MARITALSTATUS := 1;
  L_GENDER := 1;
END IF;

-- Single,Male,Son
IF  HDR.COLUMN_NAME = 'COLUMN33' OR HDR.COLUMN_NAME = 'COLUMN34' OR HDR.COLUMN_NAME = 'COLUMN35' OR HDR.COLUMN_NAME = 'COLUMN36' THEN
  L_RELATION := 1;
  L_MARITALSTATUS := 0;
  L_GENDER := 0;  
END IF;

-- Married,Male,Son
IF HDR.COLUMN_NAME = 'COLUMN37' OR HDR.COLUMN_NAME = 'COLUMN38' OR HDR.COLUMN_NAME = 'COLUMN39' OR HDR.COLUMN_NAME = 'COLUMN40'  THEN
  L_RELATION := 1;
  L_MARITALSTATUS := 1;
  L_GENDER := 0;
END IF;

-- Single,Female,Dtr
IF HDR.COLUMN_NAME = 'COLUMN41' OR HDR.COLUMN_NAME = 'COLUMN42' OR HDR.COLUMN_NAME = 'COLUMN43' OR HDR.COLUMN_NAME = 'COLUMN44'  THEN
  L_RELATION := 5;
  L_MARITALSTATUS := 0;
  L_GENDER := 1;    
END IF;

-- Married,Female,Dtr
IF HDR.COLUMN_NAME = 'COLUMN45' OR HDR.COLUMN_NAME = 'COLUMN46' OR HDR.COLUMN_NAME = 'COLUMN47' OR HDR.COLUMN_NAME = 'COLUMN48' THEN
  L_RELATION := 5;
  L_MARITALSTATUS := 1;
  L_GENDER := 1;
END IF;

--  Father
IF HDR.COLUMN_NAME = 'COLUMN49' OR HDR.COLUMN_NAME = 'COLUMN50' THEN
  L_RELATION := 2;
  L_MARITALSTATUS := 1;
  L_GENDER := 0;    
END IF;

-- Mother
IF HDR.COLUMN_NAME = 'COLUMN51' OR HDR.COLUMN_NAME = 'COLUMN52' THEN
  L_RELATION := 6;
  L_MARITALSTATUS := 1;
  L_GENDER := 1;    
END IF;

INSERT INTO IM_PR_QUOTATION_LINK
SELECT HDR.COLUMN_NAME,L_FROMAGE,L_TOAGE,L_GENDER,L_RELATION,L_MARITALSTATUS
FROM DUAL;
COMMIT; 
END LOOP;
END;


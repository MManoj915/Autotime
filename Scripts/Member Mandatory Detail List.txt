SELECT MPOL.AMEMBERNAME,MPOL.ACARDID,NVL(GRP1.GROUP_NAME,GRP.GROUP_NAME) GROUPNAME,To_Date(IM.DATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,G.CONSTANTNAME GENDER,
CEIL(MONTHS_BETWEEN(SYSDATE, IM.DATE_OF_BIRTH) / 12) AS AGE,G2.CONSTANTNAME NATIONALITY,G2.CONSTANTNAME MARITALSTATUS,
GEN2.CONSTANTNAME RELATION,CAT.CATEGORY_ID,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
To_Char(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,(SELECT SUM (PREMIUM_VALUE)
FROM IM_MEMBERPOLICYPREMIUMDTL DTL
WHERE DTL.MEMBERPOLICYCODE = MPOL.MEMBERPOLICYCODE) ADDITIONPREMIUM,
(SELECT SUM (PREMIUM_VALUE)
FROM IM_MEMPOLICYREFUNDPREMDTL DTL
WHERE DTL.MEMBERPOLICYCODE = MPOL.MEMBERPOLICYCODE) REFUNDPREMIUM FROM IM_MEMBERPOLICY MPOL
JOIN IM_MEMBERS IM ON IM.MEMBER_CODE = MPOL.MEMBERCODE
JOIN IM_CATEGORIES CAT ON CAT.CATEGORY_CODE = MPOL.CATEGORYCODE
LEFT JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = IM.GROUP_CODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.GROUP_CODE = IM.PARENTGROUPCODE
LEFT JOIN GENCONSTANT G ON G.CONSTANTVALUE = IM.GENDER AND G.CATEGORY='GENDER' AND Upper(G.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G1 ON G1.CONSTANTVALUE = IM.NATIONALITY AND G1.CATEGORY='FND_NATIONALITY' AND Upper(G1.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G2 ON G2.CONSTANTVALUE = IM.MARITAL_STATUS AND G2.CATEGORY='MARITAL_STATUS' AND Upper(G2.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GEN2 ON     GEN2.CONSTANTVALUE = IM.RELATION AND GEN2.CATEGORY = 'MEMBERRELATION' AND UPPER (GEN2.LANGUAGECODE) = 'EN-US'
WHERE MPOL.MEMBERPOLICYCODE IN(SELECT MEMBERPOLICYCODE FROM IM_POLICYFINANCEPOSTINGDTL WHERE POLICYFINANCEPOSTINGCODE = 100000000000073519)

 
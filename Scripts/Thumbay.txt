SELECT PROVIDERID,PROVIDERNAME,ACR_FORM_NO,INVOICENUMBER,To_Char(TRANSACTIONDATE,'DD/MM/RRRR'),
To_Char(ENCOUNTER_START_DATE,'DD/MM/RRRR'),REQUEST_AMOUNT,APPROVED_AMOUNT,PAYMENTREFNO,
To_Char(PAYMENTREFDATE,'DD/MM/RRRR') PAYMENTDATE
FROM IM_CLAIM_PROCESS_HEADER H
JOIN IM_PROVIDERS P ON H.PROVIDER_CODE = P.PROVIDERCODE
JOIN IM_MEMBERPOLICY M ON M.MEMBERPOLICYCODE = H.MEMBERPOLICYCODE  
LEFT JOIN ECLAIMS E ON E.CLAIMHEADERPK = H.CLAIM_CODE
WHERE  To_Date(ENCOUNTER_START_DATE,'DD/MM/RRRR') BETWEEN
To_Date('01/01/2017','DD/MM/RRRR') AND To_Date('31/12/2017','DD/MM/RRRR')
AND PROVIDERID='M207';



SELECT * FROM(SELECT PRO.PROVIDERID HNMCODE,CPH.CARDNO MEMBERID,CPH.ACR_FORM_NO FORMNO,
IMP.AMEMBERNAME MEMBERNAME,( SELECT LISTAGG (IMVD.SHORTDESC, ',')WITHIN GROUP (ORDER BY IMVD.SHORTDESC) FROM IM_CLAIM_PROCESS_DETAIL DTL
LEFT JOIN IM_ACTIVITY_TYPES ACTTYP ON ACTTYP.TYPECODE = DTL.ACTIVITY_CODE JOIN IM_VERSION_DETALIS IMVD ON IMVD.DETAILCODE = DTL.VERSIONDETAILCODE
WHERE ACTTYP.VALUE = -1 AND DTL.CLAIM_CODE = CPH.CLAIM_CODE  AND ROWNUM < 10  GROUP BY DTL.CLAIM_CODE) ICDCODES,
TO_CHAR(CPH.ENCOUNTER_START_DATE) TREATMENTSTARTDATE,IMC.NAME PHYSCODE,CPH.INVOICENUMBER INVOICENO,IVD.CODE CPTCODE,
DTL.REQUESTAMOUNT,DTL.TOTAL APPROVED_AMOUNT,DTL.DENIAL_VALUE DECLINEAMOUNT,IVDD.CODE DECLINECODE,
PAYMENTREFNO,
To_Char(PAYMENTREFDATE,'DD/MM/RRRR') PAYMENTDATE   
FROM IM_CLAIM_PROCESS_HEADER CPH
LEFT JOIN IM_CLAIM_PROCESS_DETAIL DTL ON DTL.CLAIM_CODE = CPH.CLAIM_CODE AND NVL(DTL.TYPE,0) = 0
LEFT JOIN IM_VERSION_DETALIS IVD ON IVD.DETAILCODE = DTL.VERSIONDETAILCODE
LEFT JOIN IM_VERSION_DETALIS IVDD ON IVDD.DETAILCODE = DTL.DENIAL_REASON
LEFT JOIN IM_BENEFIT_CODES IBC ON IBC.BENEFIT_CODE = DTL.BENEFIT_CODE
JOIN IM_MEMBERS_MAT_VW IMP ON IMP.MEMBERPOLICYCODE = CPH.MEMBERPOLICYCODE  
JOIN IM_PROVIDERS PRO ON PRO.PROVIDERCODE = CPH.PROVIDER_CODE
JOIN IM_CORDPRINT IMCOP ON IMCOP.MEMBERCODE = IMP.MEMBERCODE AND IMCOP.POLICYCODE = IMP.POLICYCODE AND IMCOP.CATEGORYCODE = IMP.CATEGORYCODE
LEFT JOIN IM_CLINICIANS IMC ON IMC.CDCODE = CPH.CDCODE    
LEFT JOIN IM_POLICY POL ON POL.POLICYCODE = IMP.POLICYCODE AND IMP.TYPEE = 1
LEFT JOIN IM_INDIVIDUALPOLICY IPOL ON IPOL.INDIVIDUALPOLICYCODE = IMP.POLICYCODE AND IMP.TYPEE = 2
LEFT JOIN GENCONSTANT  IGEN ON IGEN.CONSTANTVALUE=NVL(IMC.SPECIALTY,310) AND IGEN.CATEGORY='SPECIALTY' AND  UPPER(IGEN.LANGUAGECODE)='EN-US'
WHERE  PRO.PROVIDERID = 'M207' AND
CPH.REQUEST_TYPE IN(1,2,3) AND
To_Date(CPH.ENCOUNTER_START_DATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2017','DD/MM/RRRR') AND To_Date('31/12/2017','DD/MM/RRRR')

);   





                                                          
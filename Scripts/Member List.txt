SELECT * FROM(SELECT FIRST_NAME,MIDDLENAME,LAST_NAME,EMIRATES_ID,UIDNUMBER,APM_ACTIVE_FLAG FILENUMBER,PASSPORT_NO,
M.MEMBER_ID INSURANCEUNIQUEID,'NGI' INSURANCECOMPANY,'' TPACOMPANY,GETDHANWNAME(1,P.POLICYCODE,M.CATEGORY_CODE) INSURANCENETWORK,
Decode(GENDER,0,'Male',1,'Female') GENDER,DATE_OF_BIRTH,
P.STARTDATE EFFECTIVE_FROM_DATE,P.ENDDATE EFFECTIVE_END_DATE,COVERED_END_DATE,'' REMARKS,CONSTANTNAME MANAGEDBY,P.POLICYID FROM IM_MEMBERS M
JOIN IM_POLICY P ON P.POLICYCODE = M.POLICYCODE AND M.POLICYTYPE = 1
JOIN GENCONSTANT G ON G.CATEGORY = 'NGIQUOTATIONTYPE' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = P.OWNERCODE
WHERE To_Date(M.COVERED_FROM_DATE,'DD/MM/RRRR') > To_Date('01/01/2018','DD/MM/RRRR')
--AND  To_Date(P.STARTDATE,'DD/MM/RRRR') > To_Date('01/01/2017','DD/MM/RRRR')     
AND  Nvl(To_Date(M.COVERED_END_DATE,'DD/MM/RRRR'),To_Date(P.ENDDATE,'DD/MM/RRRR')) > To_Date('30/06/2018','DD/MM/RRRR') 
AND M.CATEGORY_CODE NOT IN
(SELECT CATEGORY_CODE FROM IM_CATEGORIES WHERE Upper(CATEGORY_ID) LIKE '%AUH%'  OR Upper(CATEGORY_NAME) LIKE '%AUH%')       
AND FIRST_NAME <> 'DUMMY' AND  Upper(FIRST_NAME) NOT LIKE '%INCEPTION%'   AND  Upper(FIRST_NAME) NOT LIKE '%MEMBER%' 
UNION
SELECT  FIRST_NAME,MIDDLENAME,LAST_NAME,EMIRATES_ID,UIDNUMBER,APM_ACTIVE_FLAG FILENUMBER,PASSPORT_NO,
M.MEMBER_ID INSURANCEUNIQUEID,'NGI' INSURANCECOMPANY,'' TPACOMPANY,GETDHANWNAME(2,P.INDIVIDUALPOLICYCODE,M.CATEGORY_CODE) INSURANCENETWORK,
Decode(GENDER,0,'Male',1,'Female') GENDER,DATE_OF_BIRTH,
P.STARTDATE EFFECTIVE_FROM_DATE,P.ENDDATE EFFECTIVE_END_DATE,COVERED_END_DATE,'' REMARKS,CONSTANTNAME MANAGEDBY,P.POLICYID FROM IM_MEMBERS M
JOIN IM_INDIVIDUALPOLICY P ON P.INDIVIDUALPOLICYCODE = M.POLICYCODE AND M.POLICYTYPE = 2
JOIN GENCONSTANT G ON G.CATEGORY = 'NGIQUOTATIONTYPE' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = P.OWNERCODE
WHERE To_Date(M.COVERED_FROM_DATE,'DD/MM/RRRR') > To_Date('01/01/2018','DD/MM/RRRR')
--AND  To_Date(P.STARTDATE,'DD/MM/RRRR') > To_Date('01/01/2017','DD/MM/RRRR')
AND  Nvl(To_Date(M.COVERED_END_DATE,'DD/MM/RRRR'),To_Date(P.ENDDATE,'DD/MM/RRRR')) > To_Date('30/06/2018','DD/MM/RRRR') 
AND M.CATEGORY_CODE NOT IN
(SELECT CATEGORY_CODE FROM IM_CATEGORIES WHERE Upper(CATEGORY_ID) LIKE '%AUH%'  OR Upper(CATEGORY_NAME) LIKE '%AUH%')  
AND FIRST_NAME <> 'DUMMY'  AND  Upper(FIRST_NAME) NOT LIKE '%INCEPTION%' AND  Upper(FIRST_NAME) NOT LIKE '%MEMBER%' ) 
SELECT JV.REFDATE INVOICEDATE,'' DATEOFSUPPLY,JV.REF_NO INVOICENUMBER,MPOL.AMEMBERNAME,MPOL.A_ADDRESS,
'UAE' CUSTOMERLOCATION,'DUBAI' BRANCH,GRP.TRNNO,'MEDICAL' POLICYTYPE,'MEDICAL' DESCRIPTION,
(ADDITIONAMOUNT-DELETIONAMOUNT) AMOUNT,0 POLICYFEE,(ADDITIONAMOUNT-DELETIONAMOUNT) GROSSAMOUNT,
0 DISCOUNT,(VATAMOUNT-REFUNDVATAMOUNT) TAXABLEAMOUNT,5 TAX,(VATAMOUNT-REFUNDVATAMOUNT)*0.05 TAXAMOUNT,
'' TAXINVOICE,'N' CREDITISSUED,'N' ADVANCE,'' DATEOFSUPPLY2,
CASE WHEN V.POLICYSTARTDATE-V.ADDITIONDATE < 15 THEN 'YES'
WHEN V.POLICYSTARTDATE-V.DELETIONDATE < 15 THEN 'YES'
ELSE 'NO' END AS INVOICEISSUEDWITHIN14,'' VATCOLLECTION,'' DATEOFRECEIPT,'DUBAI' PLACEOFSUPPLY,
1 CONVERSIONRATE
 FROM IM_NGI_JVPOSTING JV
LEFT JOIN IM_POLICY POL ON POL.POLICYCODE = JV.POLICYCODE AND JV.POLICYTYPE=0
LEFT JOIN IM_INDIVIDUALPOLICY IPOL ON IPOL.INDIVIDUALPOLICYCODE = JV.POLICYCODE AND JV.POLICYTYPE=1
LEFT JOIN IM_GROUPS GRP ON GRP.GROUP_CODE=POL.GROUPCODE    
JOIN IM_POLICYFINANCE_VAT V ON V.POLICYFINANCEPOSTINGCODE = JV.REF_CODE
JOIN IM_MEMBERPOLICY MPOL ON MPOL.MEMBERPOLICYCODE = V.MEMBERPOLICYCODE
WHERE JV.JVPREMIUMTYPE = 0 AND 
To_Date(JV.REFDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2018','DD/MM/RRRR')
AND  To_Date('31/01/2018','DD/MM/RRRR') AND REF_CODE IS NOT NULL
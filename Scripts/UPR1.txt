INSERT INTO  IM_EFORM_UPR_DETAIL      
SELECT ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTDATE,CARDNUMBER,A.UWYEAR,A.POLICYNUMBER,A.PRODUCTNAME,
To_Date(A.BENEFICIARYSTARTDATE,'DD/MM/RRRR'),To_Date(Nvl(A.BENEFICIARYENDDATE,A.CONTRACTEXPIRYDATE),'DD/MM/RRRR'),
A.TOTALPREMIUM,P.NGI_FEES,(A.TOTALPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100),
Nvl(AGENTCOM,0),Nvl(ADMINFEE,0),Nvl(A.TPAFEE,0),A.NGI_FEES,
2,A.MANAGEDBY,A.BRANCHNAME,'122018',
CARDNUMBER,0,0,0,0,0,0,0,0,
NULL,IPPREMIUM,OPPREMIUM,0,P.POLICYCODE,
CLINE,TDTL.FACULTATIVEPERCENTAGE,P.OWNERCODE,0,0,0,0,0,0,0,0,CLINE,0,'N',0,0,P.STARTDATE,P.ENDDATE,TRT.TREATYNAME  
 FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE NOT IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4  AND  TDTL.INSURERCODE <> 100000000000000003 ;


INSERT INTO  IM_EFORM_UPR_DETAIL      
SELECT ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTDATE,CARDNUMBER,A.UWYEAR,A.POLICYNUMBER,A.PRODUCTNAME,
To_Date(A.BENEFICIARYSTARTDATE,'DD/MM/RRRR'),To_Date(Nvl(A.BENEFICIARYENDDATE,A.CONTRACTEXPIRYDATE),'DD/MM/RRRR'),
A.TOTALPREMIUM,P.NGI_FEES,0,
Nvl(AGENTCOM,0),Nvl(ADMINFEE,0),Nvl(A.TPAFEE,0),A.NGI_FEES,
1,A.MANAGEDBY,A.BRANCHNAME,'122018',
CARDNUMBER,0,0,0,0,0,0,0,0,
NULL,IPPREMIUM,OPPREMIUM,0,P.POLICYCODE,
CLINE,TDTL.FACULTATIVEPERCENTAGE,P.OWNERCODE,0,0,0,0,0,0,0,0,CLINE,0,'N',0,0,P.STARTDATE,P.ENDDATE,TRT.TREATYNAME  
 FROM ICA A,IM_POLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'GROUP' AND A.POLICYNUMBER = P.POLICYID   AND P.POLICYCODE = DTL.POLICYCODE   
AND P.POLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE NOT IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4  AND  TDTL.INSURERCODE = 100000000000000003    ;


INSERT INTO  IM_EFORM_UPR_DETAIL      
SELECT ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTDATE,CARDNUMBER,A.UWYEAR,A.POLICYNUMBER,A.PRODUCTNAME,
To_Date(A.BENEFICIARYSTARTDATE,'DD/MM/RRRR'),To_Date(Nvl(A.BENEFICIARYENDDATE,A.CONTRACTEXPIRYDATE),'DD/MM/RRRR'),
A.TOTALPREMIUM,P.NGI_FEES,(A.TOTALPREMIUM)*(TDTL.FACULTATIVEPERCENTAGE/100),
Nvl(AGENTCOM,0),Nvl(ADMINFEE,0),Nvl(A.TPAFEE,0),A.NGI_FEES,
2,A.MANAGEDBY,A.BRANCHNAME,'122018',
CARDNUMBER,0,0,0,0,0,0,0,0,
NULL,IPPREMIUM,OPPREMIUM,1,P.INDIVIDUALPOLICYCODE,
CLINE,TDTL.FACULTATIVEPERCENTAGE,P.OWNERCODE,0,0,0,0,0,0,0,0,CLINE,0,'N',0,0,P.STARTDATE,P.ENDDATE,TRT.TREATYNAME  
 FROM ICA A,IM_INDIVIDUALPOLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'INDIVIDUAL' AND A.POLICYNUMBER = P.POLICYID   AND P.INDIVIDUALPOLICYCODE = DTL.INDIVIDUALPOLICYCODE   
AND P.INDIVIDUALPOLICYCODE = A.POLICYCODE
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE NOT IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4  AND  TDTL.INSURERCODE <> 100000000000000003    ;


INSERT INTO  IM_EFORM_UPR_DETAIL      
SELECT ENDORESMENTID,To_Date(A.ENDORESMENTDATE,'DD/MM/RRRR') DOCUMENTDATE,CARDNUMBER,A.UWYEAR,A.POLICYNUMBER,A.PRODUCTNAME,
To_Date(A.BENEFICIARYSTARTDATE,'DD/MM/RRRR'),To_Date(Nvl(A.BENEFICIARYENDDATE,A.CONTRACTEXPIRYDATE),'DD/MM/RRRR'),
A.TOTALPREMIUM,P.NGI_FEES,0,
Nvl(AGENTCOM,0),Nvl(ADMINFEE,0),Nvl(A.TPAFEE,0),A.NGI_FEES,
1,A.MANAGEDBY,A.BRANCHNAME,'122018',
CARDNUMBER,0,0,0,0,0,0,0,0,
NULL,IPPREMIUM,OPPREMIUM,1,P.INDIVIDUALPOLICYCODE,
CLINE,TDTL.FACULTATIVEPERCENTAGE,P.OWNERCODE,0,0,0,0,0,0,0,0,CLINE,0,'N',0,0,P.STARTDATE,P.ENDDATE,TRT.TREATYNAME  
FROM ICA A,IM_INDIVIDUALPOLICY P,IM_POLICY_INSURER_DTL DTL,IM_POLICY_INSURER_SUBDTL SDTL,
IM_TREATY_HDR TRT,IM_TREATY_DTL TDTL,GENCONSTANT G,IM_INSURER INS 
WHERE To_Date(ENDORESMENTDATE,'DD/MM/RRRR')
BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')  
AND Upper(POLICYTYPE) = 'INDIVIDUAL' AND A.POLICYNUMBER = P.POLICYID   AND P.INDIVIDUALPOLICYCODE = DTL.INDIVIDUALPOLICYCODE   
AND P.INDIVIDUALPOLICYCODE = A.POLICYCODE   
AND DTL.POLICYINSURERDTLCODE = SDTL.POLICYINSURERDTLCODE  AND SDTL.TREATYHDRCODE = TRT.TREATYHDRCODE 
AND G.CATEGORY='PREMIUMTYPES' AND G.LANGUAGECODE = 'en-US' AND G.CONSTANTVALUE = SDTL.PREMIUMTYPE
AND TRT.TREATYHDRCODE = TDTL.TREATYHDRCODE AND P.OWNERCODE NOT IN(11,14,15,22,23) AND INS.INSCODE = TDTL.INSURERCODE 
AND SDTL.PREMIUMTYPE = 4  AND  TDTL.INSURERCODE = 100000000000000003    ;




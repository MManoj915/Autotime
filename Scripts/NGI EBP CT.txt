BEGIN
FOR HDR IN(SELECT * FROM IM_POLCATESETTINGAGELIMITS WHERE GENDERCODE = 1 AND   APPLICABLEFOR = 1 AND PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE=100000000000024016 ) AND AGEFROM < 46) LOOP
UPDATE IM_INDCATESETTINGAGELIMITS SET CARDTEXT = HDR.CARDTEXT 
WHERE GENDERCODE = 1 AND   APPLICABLEFOR = 1 AND POLICYCATEGORYCODE IN
(SELECT POLICYCATEGORYCODE FROM IM_NGIINDPOLICYCATEGORY WHERE INDIVIDUALPOLICYCODE IN
(SELECT INDIVIDUALPOLICYCODE FROM IM_INDIVIDUALPOLICY WHERE OWNERCODE = 21 AND PORTALTYPE = 'PR'))   AND AGEFROM < 46 ;
COMMIT;
END LOOP;
END;



BEGIN
FOR HDR IN(SELECT * FROM IM_POLCATESETTINGAGELIMITS WHERE GENDERCODE = 0 AND PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE=100000000000024016 )  ) LOOP
UPDATE IM_INDCATESETTINGAGELIMITS SET CARDTEXT = HDR.CARDTEXT 
WHERE  POLICYCATEGORYCODE IN
(SELECT POLICYCATEGORYCODE FROM IM_NGIINDPOLICYCATEGORY WHERE INDIVIDUALPOLICYCODE IN
(SELECT INDIVIDUALPOLICYCODE FROM IM_INDIVIDUALPOLICY WHERE OWNERCODE = 21 AND PORTALTYPE = 'PR'))  AND CARDTEXT IS NULL ;
COMMIT;
END LOOP;
END;



BEGIN
FOR HDR IN(SELECT * FROM IM_POLCATESETTINGAGELIMITS WHERE GENDERCODE = 1 AND   APPLICABLEFOR = 1 AND PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE=100000000000024016 ) AND AGEFROM < 46) LOOP
UPDATE IM_POLCATESETTINGAGELIMITS SET CARDTEXT = HDR.CARDTEXT 
WHERE GENDERCODE = 1 AND   APPLICABLEFOR = 1 AND PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE IN
(SELECT POLICYCODE FROM IM_POLICY WHERE OWNERCODE = 21 AND PORTALTYPE = 'PR'))   AND AGEFROM < 46 ;
COMMIT;
END LOOP;
END;



BEGIN
FOR HDR IN(SELECT * FROM IM_POLCATESETTINGAGELIMITS WHERE GENDERCODE = 0 AND PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE=100000000000024016 )  ) LOOP
UPDATE IM_POLCATESETTINGAGELIMITS SET CARDTEXT = HDR.CARDTEXT 
WHERE  PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE IN
(SELECT POLICYCODE FROM IM_POLICY WHERE OWNERCODE = 21 AND PORTALTYPE = 'PR'))  AND CARDTEXT IS NULL ;
COMMIT;
END LOOP;
END;




BEGIN
FOR HDR IN(SELECT *  FROM IM_NGIINDPOLICYCATEGORY  WHERE INDIVIDUALPOLICYCODE IN
(SELECT INDIVIDUALPOLICYCODE FROM IM_INDIVIDUALPOLICY WHERE PORTALTYPE = 'PR' AND OWNERCODE = 21)) LOOP

DELETE FROM IM_INDIVIDUALPOLICYBEBEFITS WHERE POLICYCATEGORYCODE = HDR.POLICYCATEGORYCODE;
COMMIT;
FOR DTL IN (SELECT * FROM IM_POLICYBEBEFITS  WHERE PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE =100000000000024016)) LOOP

Insert into IM_INDIVIDUALPOLICYBEBEFITS
(POLICYBEBEFITSCODE, 
POLICYCATEGORYCODE, BENEFIT_CODE, TYPECODE, ACTIVE, COMPANYCODE, 
CREATEDBY, LASTMODIFIEDBY, CREATEDON, LASTMODIFIEDON, LOCATIONCODE, 
SERIALNO, DEFAULTPREMIUM, APPLYSETTINGPREMIUM, APPLYFULLPERMIUMREFUND, 
CARDTEXT)
Values
((SELECT Max(POLICYBEBEFITSCODE)+1 FROM IM_INDIVIDUALPOLICYBEBEFITS), HDR.POLICYCATEGORYCODE, DTL.BENEFIT_CODE, DTL.TYPECODE, 1, 
1, 100000000000001417, 100000000000001136, TO_DATE('05/08/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), TO_DATE('07/12/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
1, (SELECT MAX(SERIALNO) + 1 FROM IM_INDIVIDUALPOLICYBEBEFITS), NULL, 0, 
0, DTL.CARDTEXT);
COMMIT;

END LOOP;

END LOOP;
END;

BEGIN
FOR HDR IN(SELECT *  FROM IM_POLICY_CATEGORYDTL  WHERE POLICYCODE IN
(SELECT POLICYCODE FROM IM_POLICY WHERE PORTALTYPE = 'PR' AND OWNERCODE = 21)) LOOP

DELETE FROM IM_POLICYBEBEFITS WHERE PCDCODE = HDR.PCDCODE;
COMMIT;
FOR DTL IN (SELECT * FROM IM_POLICYBEBEFITS  WHERE PCDCODE IN
(SELECT PCDCODE FROM IM_POLICY_CATEGORYDTL WHERE POLICYCODE =100000000000024016)) LOOP

Insert into IM_POLICYBEBEFITS
(POLICYBEBEFITSCODE, 
PCDCODE, BENEFIT_CODE, TYPECODE, ACTIVE, COMPANYCODE, 
CREATEDBY, LASTMODIFIEDBY, CREATEDON, LASTMODIFIEDON, LOCATIONCODE, 
SERIALNO, BENEFIT_TYPE, DEFAULTPREMIUM, APPLYSETTINGPREMIUM, APPLYFULLPERMIUMREFUND, 
CARDTEXT)
Values
((SELECT Max(POLICYBEBEFITSCODE)+1 FROM IM_POLICYBEBEFITS), HDR.PCDCODE, DTL.BENEFIT_CODE, DTL.TYPECODE, 1, 
1, 100000000000001417, 100000000000001136, TO_DATE('05/08/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), TO_DATE('07/12/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
1, (SELECT MAX(SERIALNO) + 1 FROM IM_POLICYBEBEFITS), DTL.BENEFIT_TYPE, NULL, 0, 
0, DTL.CARDTEXT);
COMMIT;

END LOOP;

END LOOP;
END;


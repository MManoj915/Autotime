
BEGIN
FOR DTL IN(SELECT * FROM IM_MEMBERPOLICY WHERE ACARDID IN
(SELECT ACARDID FROM   IM_MEMBERPOLICY WHERE ADDMEMBERPOLICYCODE IN(100000000000046231,100000000000046232,100000000000046366)
GROUP BY ACARDID HAVING COUNT(*) > 1
)
) LOOP   
INSERT INTO IM_DELCAN_MEMBERSDTL
(POLICY_MEM_CODE,
DCMEMBER_CODE, LOCATION, CREATEDIN, CREATEDON, CREATEDBY,
LASTMODIFIEDON, LASTMODIFIEDBY, LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE,
COMPANYCODE, SERIALNO, MEMBERCODE, MEMBERPOLICYCODE, BASEPREMIUM,
EFFECTIVEDATE)
VALUES
((SELECT Max(POLICY_MEM_CODE)+1 FROM IM_DELCAN_MEMBERSDTL),100000000000023217, NULL, NULL,
SYSDATE,100000000000000002, NULL, NULL, NULL, NULL,
1, 1, (SELECT Max(SERIALNO)+1 FROM IM_DELCAN_MEMBERSDTL),DTL.MEMBERCODE, DTL.MEMBERPOLICYCODE,
NULL,DTL.MEMBERSTARTDATE);
COMMIT;
END LOOP;
END;



BEGIN
FOR I IN(SELECT DISTINCT MEMBERNAME,DATE_OF_BIRTH FROM IM_ADDMEMBERDET WHERE MEMBERCODE IN(SELECT MEMBERCODE FROM IM_MEMBERPOLICY WHERE ACARDID IN
(SELECT ACARDID FROM   IM_MEMBERPOLICY WHERE ADDMEMBERPOLICYCODE IN(100000000000046231,100000000000046232,100000000000046366)
GROUP BY ACARDID HAVING COUNT(*) > 1
))) LOOP
INSERT INTO IM_ADDMEMBERDET
(ADDMEMBERDETCODE, ADDMEMBERPOLICYCODE, DATE_OF_BIRTH, GENDERCODE, MEMBERRELATIONCODE,
MARITALSTATUSCODE, CATEGORYCODE, NATIONALITYCODE,
CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY,
LOCATIONCODE, COMPANYCODE,
SERIALNO, PARENTID,  EXISTING_INSURER,
OCCUPATION, ADDRESS1, ADDRESS2, PHONE_NO, MOBILE_NO,
EMAIL_ID, PASSPORT_NO, HEIGHT, WEIGHT, EMIRATES_ID, STAFF_ID, LOADING_PCT,
PARENTGROUPCODE, SNO,MEMBERID, MEMBERNAME,SECONDNAME, FAMILYNAME,DATE_OF_ENTRY, ENTRYTYPE, LOCATION,
RESIDENTLOCATION,WORKLOCATION,SALARYBAND,
ISCOMMISSION,ENTITYTYPE,ENTITYID,UIDNUMBER, ISPREEXISTING,MEMBERENTITYIDNAME,EFFECTIVEDATE )
VALUES
((SELECT Max(ADDMEMBERDETCODE) + 1 FROM IM_ADDMEMBERDET),100000000000047207,I.DATE_OF_BIRTH,I.GENDERCODE,I.MEMBERRELATIONCODE,
I.MARITALSTATUSCODE,I.CATEGORYCODE,I.NATIONALITYCODE,SYSDATE,'100000000000000002',SYSDATE,'100000000000000002',
1,1,(SELECT Max(ADDMEMBERDETCODE) + 1 FROM IM_ADDMEMBERDET),I.PARENTID,NULL,
I.OCCUPATION,I.ADDRESS1,I.ADDRESS2,I.PHONE_NO,I.MOBILE_NO,
I.EMAIL_ID,I.PASSPORT_NO,NULL,NULL,I.EMIRATES_ID,I.STAFF_ID,NULL,I.PARENTGROUPCODE,I.SNO,
I.MEMBERID, I.MEMBERNAME,i.SECONDNAME,I.FAMILYNAME,I.DATE_OF_ENTRY, I.ENTRYTYPE, I.LOCATION,
I.RESIDENTLOCATION, I.WORKLOCATION, I.SALARYBAND,
I.ISCOMMISSION,I.ENTITYTYPE,I.ENTITYID,I.UIDNUMBER,NULL,I.ENTITYID,I.EFFECTIVEDATE);
COMMIT;
END LOOP;
END;

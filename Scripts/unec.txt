DECLARE L_PARENTID VARCHAR2(50);
BEGIN 
FOR HDR IN(SELECT * FROM IM_MEMBERS WHERE MEMBER_CODE IN
(SELECT   IM.MEMBERCODE FROM IM_POLICY_MEMBERS IM  WHERE IM.POLICYCODE=100000000000023440
AND   IM.MEMBERCODE NOT IN
(SELECT MEMBERCODE FROM IM_MEMBERPOLICY WHERE ACARDID IN
(SELECT CARDNO FROM UNEC)))) LOOP

IF Nvl(HDR.PARENT_ID,0) <> 0 THEN
SELECT MEMBER_ID INTO L_PARENTID FROM IM_MEMBERS WHERE MEMBER_CODE = HDR.PARENT_ID;
ELSE
L_PARENTID := HDR.MEMBER_ID;
END IF; 
INSERT INTO CAPPS.IM_POLICY_MEMBERS
(POLICY_MEM_CODE, 
POLICYCODE, DATE_OF_BIRTH, MEMBER_GENDER, MEMBER_RELATION, MARITAL_STATUS, 
MEMBER_CATEGORY, NATIONALITY, LOCATION, CREATEDIN, CREATEDON, 
CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, LEGALENTITYCODE, CUSTOMERCODE, 
LOCATIONCODE, COMPANYCODE, SERIALNO, MEMBERCODE, MEMBERID, 
MEMBERNAME, PARENTID, INCEPTION_DATE, MEMBER_TYPE, EXISTING_INSURER, 
DATE_OF_ENTRY, OCCUPATION, ADDRESS1, ADDRESS2, PHONE_NO, 
MOBILE_NO, EMAIL_ID, PASSPORT_NO, HEIGHT, WEIGHT, 
EMIRATES_ID, STAFF_ID, DISCOUNT_PCT, LOADING_PCT, PARENTGROUPCODE, 
SUB_GROUP_ID, COCEXPIRY, ISEXISTINGMEMBER, SNO, MEMBERSINCE, 
ENTRYTYPE, HAADFINE, WAIVEAMOUNT, NOOFDAYS, WORKLOCATION, 
RESIDENTLOCATION, ISCOMMISSION, SALARYBAND, UIDNUMBER, ISPREEXISTING, 
ENTITYTYPE, ENTITYID, SECONDNAME, FAMILYNAME, MEMBERENTITYIDNAME, 
VALID)
VALUES                                                                                           
((SELECT MAX(POLICY_MEM_CODE)+1 FROM IM_POLICY_MEMBERS), 100000000000023440,HDR.DATE_OF_BIRTH,HDR.GENDER, HDR.RELATION, 
HDR.MARITAL_STATUS, HDR.CATEGORY_CODE, HDR.NATIONALITY, NULL, 1, 
TO_DATE('02/26/2018 16:28:55', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000002, 
TO_DATE('02/26/2018 16:28:55', 'MM/DD/YYYY HH24:MI:SS'), 100000000000000002, 100000000000000001, 
100000000000000001, 1, 1, (SELECT MAX(SERIALNO)+1 FROM IM_POLICY_MEMBERS), HDR.MEMBER_CODE, 
HDR.MEMBER_ID,HDR.FIRST_NAME||' '||HDR.MIDDLENAME||' '||HDR.LAST_NAME,L_PARENTID, 
HDR.COVERED_FROM_DATE, NULL, 
NULL, NULL, NULL, NULL,NULL, HDR.PHONE_NO, 
 HDR.MOBILE_NO, HDR.EMAIL_ID, HDR.PASSPORT_NO, NULL, 
NULL, HDR.EMIRATES_ID,HDR.STAFF_ID, NULL, NULL, 
NULL, NULL, NULL, 0, NULL, 
NULL, NULL, 0, 0, NULL, 
HDR.WORKLOCATION, HDR.RESIDENTLOCATION, HDR.ISCOMMISSION, HDR.SALARYBAND,
 HDR.UIDNUMBER, 
NULL, HDR.ENTITYTYPE, NULL, NULL, NULL, 
HDR.MEMBERENTITYIDNAME, NULL);
COMMIT;
END LOOP;
END;

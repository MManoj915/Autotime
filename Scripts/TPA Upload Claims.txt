DECLARE L_POLICYCODE VARCHAR2(500);l_OWNERCODE NUMBER;
BEGIN 
FOR HDR IN(SELECT * FROM THIRDPARTYCLAIM) LOOP

SELECT Max(INDIVIDUALPOLICYCODE),Max(OWNERCODE) INTO L_POLICYCODE,l_OWNERCODE FROM IM_INDIVIDUALPOLICY WHERE POLICYID = HDR.POLICYID;      
Insert into CAPPS.IM_CLAIM_PROCESS_HEADER
   (CLAIM_CODE, 
    REQUEST_NUMBER, CPPREFIX, CPNO, CPSUFFIX, CPFULLNO, 
    AUTHORIZEDSTATUS, TRANSACTIONDATE, REQUEST_SOURCE, REQUEST_TYPE, REQUEST_STATUS, 
    PROVIDER_CODE, IS_BLOCKED, IS_FASTTRACE_PAYMENT, MEMBER_CODE, AUTHORIZATOIN_CODE, 
    CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
    LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, COMPANYCODE, BENEFIT_CODE, 
    REQUEST_AMOUNT, APPROVED_DATE, APPROVED_AMOUNT, TREATMENT_TYPE, ENCOUNTER_START_DATE, 
    TYPE, CLAIM_STATUS, DENIAL_REASON, CASESUMMARY, SERIALNO, 
    DENAILVALUE, PICTURE, INVOICENUMBER, DENIALREASON, REASON, 
    TYPECODE, ACTIVITYCODE, MAP_VALUE, BATCH_NUMBER, ATHORIZATOIN_CODE, 
    ENCOUNTER_END_DATE, DURATION, REQUEST_DATE, RESUBMISSION_TYPE, BATCHCODE, 
    PARENTCLAIMCODE, CURRENCYCODE, NETWORKCODE, POLICYCODE, CATEGORY_CODE, 
    ISEMERGENCY, PROVINCECODE, CDCODE, UPLOADSTATUS, DISCOUNTTOTAL, 
    ACTIVITYPRICE, CO_INS_VALUE, DEDUCTABLEVALUE, INVOICEDATE, ACR_FORM_NO, 
    ACR_FORM_TYPE, CLAIM_TYPE, NETAMOUNT, MEMBERPOLICYCODE, RESUBMISSION, 
    ISRESUBMISSION, CLAIM_REMARKS, ENCOUNTER_START_TYPE, ENCOUNTER_END_TYPE, ENCOUNTER_FACILITY_TYPE, 
    RFP, SUBMITTORA, FINANCE, ORGINALPATIENTSHARE, RATE, 
    REIMBURSEMENTAMT, SOURCE_TYPE, SOURCE_CODE, ACR_FORM_SEQ_NO, ACR_PRODUCT_CODE, 
    ACR_SERIAL_NO, ACR_PRODUCT_CATEGORY, ACR_MEMBER_NO, ACR_MEMBER_REFERENCE_NO, ACR_PROVIDER_CODE, 
    ACR_PHYSICIAN_CODE, ISPOSTED, PAYMENTREFNO, SOURCEPROVIDER, SCREENINGDONE, 
    ACR_UW_YEAR, OUTOFNETWORKPROVIDERNAME, CARDNO, ISNEXTCARE, POLICYTYPECODE, 
    NETWORKTYPE, ADMINISTRATEDBY, RESUBMISSION_COMMENTS, RESUBMISSION_ATTACHMENT, UBYMANOJ, 
    PROCESSEDDATE, TOBEDELETECLAIMS, ALREADYSCREENED, TOBEUPDATED, ACR_SEQUENCE_NO, 
    CEEDSTATUS, REVIEWEDBYDOCTOR, DECLINEAMOUNT, HNMAMOUNT, MDEDUCT, 
    MCO_INS, OLDCLAIMS, AUTOREJECT, ISDECLINEDPOSTED, ISFRAUD, 
    ISAUTOMATED, LCNT, IBNRMONTH, MEDPOSTINGDONE, ISPROCESSED, 
    CRTCLAIM, ORIGINALDEDUCTABLEAMOUNT, ORIGINALREQUESTAMOUNT, AUTOPROCESSED, CLAIMMEMBERBATCHCODE, 
    ACTCHECKHDR, ISREVERSED, PAYMENTTYPECODE, REIMBURSEMENT_FORM_NO, FORMTYPECODE, 
    BRATE, MEMOTYPE, PRICEUPDATE, MEDREFDATE, ACR_SEQ_NO, 
    ACR_INV_NO, ISCARDRESUBMISSION, ISREVERSEDFORDEBIT, ISREVERSEDFORCREDIT, PAYMENTREFDATE, 
    DISCOUNTPERCENTAGE, REVERSEREFNO, REVERSEREFDATE, NEXTCAREBATCHNO, TPACLAIMHDRCODE, 
    REINSMEMBERNAME, TEMPORGINALPATIENTSHARE, NEXTCARECLAIMHDRCODE, FMCMEMBERNAME, FMCDIAGNOSIS, 
    NEXTCAREDENIEDFOR, PRIOR_AUTHORIZATION_ID, ISPRIORAUTHORIZATION, FMCCARDNO, FMCUNIQCLAIMID, 
    FOB, RAUPLOADDATE, ISREJECT, FREQUENCYVISIT)
 Values
   ((SELECT MAX(CLAIM_CODE)+1 FROM IM_CLAIM_PROCESS_HEADER), NULL, NULL, NULL, NULL, 
    NULL, 1, TO_DATE('04/11/2018 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, 4, 
    NULL, 1000000000000001457, NULL, NULL, NULL, 
    NULL, NULL, SYSDATE, 100000000000000284,SYSDATE, 
    100000000000000284, NULL, NULL, 1, 1, 
    NULL, HDR.AMOUNT, NULL, HDR.AMOUNT, 0, 
    TO_DATE('03/16/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, 2, NULL, NULL, 
    (SELECT MAX(SERIALNO)+1 FROM IM_CLAIM_PROCESS_HEADER), NULL, NULL, REPLACE(HDR.FORMNO,'ZH',''), NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, TO_DATE('03/31/2017 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), NULL, NULL, NULL, 
    100000000000065499, NULL, NULL, NULL, L_POLICYCODE, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    HDR.FORMNO, NULL, '1', NULL, NULL, 
    NULL, 0, NULL, NULL, NULL, 
    NULL, NULL, NULL, 0, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, 1, NULL, NULL, 
    0, NULL, NULL, NULL, 1, 
    2, 1, l_OWNERCODE, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    1, 1, NULL, 0, 0, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL, 
    NULL, NULL, NULL, NULL, NULL);
COMMIT;
            

END LOOP;



UPDATE IM_CLAIM_PROCESS_HEADER SET ISPOSTED=0,FINANCE=0
WHERE ACR_FORM_NO IN
(SELECT FORMNO FROM THIRDPARTYCLAIM);
COMMIT;    
END;

SELECT * FROM(SELECT  'GROUP' POLICYTYPE,POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME,GRP.ADDRESS ADDRESS1,GRPC.ADDRESS ADDRESS2,GRPC.PHONE,GRPC.MOBILE,
G.CONSTANTNAME MANAGEDBY,GEN11.CONSTANTNAME SOURCE,Nvl(AGN.AGENT_NAME_EN,BRK.BROKER_NAME_EN) SOURCENAME ,
Sum(FIN.AMOUNT) PREMIUMAMOUNT
FROM IM_FINANCE_LINK_POSTING FIN
LEFT JOIN IM_NGI_JVPOSTING JV ON JV.REF_NO = FIN.DOCNO    
JOIN IM_POLICY POL ON POL.POLICYCODE = JV.POLICYCODE
LEFT JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = Nvl(JV.GROUPCODE,POL.GROUPCODE)
LEFT JOIN IM_AGENTS AGN ON AGN.AGENTCODE=  POL.AGENTCODE
LEFT JOIN IM_BROKERS BRK ON BRK.BROKERCODE = POL.BROKERCODE
JOIN GENCONSTANT G ON G.CATEGORY = 'NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND G.LANGUAGECODE = 'en-US'
LEFT JOIN (SELECT CONSTANTVALUE,CONSTANTNAME FROM GENCONSTANT WHERE CATEGORY='SOURCE' AND Upper(LANGUAGECODE)=Upper('EN-US'))GEN11 ON GEN11.CONSTANTVALUE=POL.REQUEST_SOURCE   
LEFT JOIN IM_GROUP_CONTACTS GRPC ON GRPC.GROUP_CODE = JV.GROUPCODE
WHERE JVPREMIUMTYPE = 0 AND JV.POLICYTYPE = 0  AND FIN.DOC_TYPE='PRM'
AND To_Date(JV.REFDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')
GROUP BY AGN.AGENT_NAME_EN,BRK.BROKER_NAME_EN,
G.CONSTANTNAME,GEN11.CONSTANTNAME,POL.POLICYID,POL.POLICYNAME,GRP.GROUP_NAME,GRP.ADDRESS,GRPC.ADDRESS,GRPC.PHONE,GRPC.MOBILE   
UNION ALL
SELECT  'INDIVIDUAL' POLICYTYPE,POL.POLICYID,POL.POLICYNAME,MEM.FIRST_NAME||' '||MEM.MIDDLENAME||' '||MEM.LAST_NAME MEMBERNAME,
MEM.ADDRESS ADDRESS1,Nvl(MEM.ADDRESS1 ,MEM.ADDRESS2) ADDRESS2,MEM.PHONE_NO,NVL(MEM.MOBILE_NO,MEM.MOBILE_NUMBER) MOBILE,
G.CONSTANTNAME MANAGEDBY,GEN11.CONSTANTNAME SOURCE,Nvl(AGN.AGENT_NAME_EN,BRK.BROKER_NAME_EN) SOURCENAME ,
Sum(FIN.AMOUNT) PREMIUMAMOUNT
FROM IM_FINANCE_LINK_POSTING FIN
LEFT JOIN IM_NGI_JVPOSTING JV    ON JV.REF_NO = FIN.DOCNO                        
JOIN IM_INDIVIDUALPOLICY POL ON POL.INDIVIDUALPOLICYCODE = JV.POLICYCODE
LEFT JOIN IM_AGENTS AGN ON AGN.AGENTCODE=  POL.AGENTCODE
LEFT JOIN IM_BROKERS BRK ON BRK.BROKERCODE = POL.BROKERCODE
JOIN GENCONSTANT G ON G.CATEGORY = 'NGIQUOTATIONTYPE' AND G.CONSTANTVALUE = POL.OWNERCODE AND G.LANGUAGECODE = 'en-US'
LEFT JOIN (SELECT CONSTANTVALUE,CONSTANTNAME FROM GENCONSTANT WHERE CATEGORY='SOURCE' AND Upper(LANGUAGECODE)=Upper('EN-US'))GEN11 ON GEN11.CONSTANTVALUE=POL.INDIPOLICYSOURCECODE   
LEFT JOIN IM_MEMBERS MEM ON MEM.MEMBER_CODE = POL.MEMBERCODE   
WHERE JVPREMIUMTYPE = 0 AND JV.POLICYTYPE = 1 AND   FIN.DOC_TYPE='PRM'
AND To_Date(JV.REFDATE,'DD/MM/RRRR') BETWEEN To_Date('01/01/2018','DD/MM/RRRR') AND To_Date('31/12/2018','DD/MM/RRRR')
GROUP BY AGN.AGENT_NAME_EN,BRK.BROKER_NAME_EN,G.CONSTANTNAME,GEN11.CONSTANTNAME,POL.POLICYID,POL.POLICYNAME,MEM.FIRST_NAME||' '||MEM.MIDDLENAME||' '||MEM.LAST_NAME,
MEM.ADDRESS,MEM.ADDRESS1,MEM.ADDRESS2,MEM.PHONE_NO,MEM.MOBILE_NO,MEM.MOBILE_NUMBER )
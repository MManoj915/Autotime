SELECT MPOL.AMEMBERNAME,MPOL.ACARDID,NVL(GRP1.GROUP_NAME,GRP.GROUP_NAME) GROUPNAME,TO_DATE(IM.DATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,G.CONSTANTNAME GENDER,
CEIL(MONTHS_BETWEEN(SYSDATE, IM.DATE_OF_BIRTH) / 12) AS AGE,G1.CONSTANTNAME NATIONALITY,G2.CONSTANTNAME MARITALSTATUS,
IM.EMIRATES_ID,IM.UIDNUMBER,IM.PASSPORT_NO,
GEN2.CONSTANTNAME RELATION,CAT.CATEGORY_ID,TO_CHAR(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ADDITIONDATE,
TO_CHAR(MPOL.MEMBERENDDATE,'DD/MM/RRRR') DELETIONDATE,POSDTL.ADDPREMIUM ADDITIONPREMIUM,
POSDTL.REFUNDPREMIUM,POSDTL.ADDPREMIUM*0.05 VATADDITION,POSDTL.REFUNDPREMIUM*0.05 VATDELETION FROM IM_POLICYFINANCEPOSTINGDTL POSDTL
JOIN IM_MEMBERPOLICY MPOL ON MPOL.MEMBERPOLICYCODE = POSDTL.MEMBERPOLICYCODE
JOIN IM_MEMBERS IM ON IM.MEMBER_CODE = MPOL.MEMBERCODE
JOIN IM_CATEGORIES CAT ON CAT.CATEGORY_CODE = MPOL.CATEGORYCODE
LEFT JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = IM.GROUP_CODE
LEFT JOIN IM_GROUPS GRP1 ON GRP1.GROUP_CODE = IM.PARENTGROUPCODE
LEFT JOIN GENCONSTANT G ON G.CONSTANTVALUE = IM.GENDER AND G.CATEGORY='GENDER' AND UPPER(G.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G1 ON G1.CONSTANTVALUE = IM.NATIONALITY AND G1.CATEGORY='FND_NATIONALITY' AND UPPER(G1.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G2 ON G2.CONSTANTVALUE = IM.MARITAL_STATUS AND G2.CATEGORY='MARITAL_STATUS' AND UPPER(G2.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GEN2 ON     GEN2.CONSTANTVALUE = IM.RELATION AND GEN2.CATEGORY = 'MEMBERRELATION' AND UPPER (GEN2.LANGUAGECODE) = 'EN-US'
WHERE POSDTL.POLICYFINANCEPOSTINGCODE IN(SELECT POLICYFINANCEPOSTINGCODE FROM IM_POLICYFINANCEPOSTING  WHERE FINANCENO = 101605
)

 
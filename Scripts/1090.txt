DECLARE

ADDMEMPOLICYROW  IM_ADDMEMBERPOLICY%ROWTYPE;
ATOTALDAYS NUMBER;
AAGE NUMBER;
AADDMEMBERDETCOUNTER NUMBER;
AADDMEMBERDETPKEY NUMBER;
ATTOTALAPPLYAMMOUNT NUMBER;
ATOTALPREMIMVALUE NUMBER;
ATOTALADDPREMIMVALUE NUMBER;
ATOTALFINALPREMIUM NUMBER;
ATOTALCOMMISIONVALUE NUMBER;
A_EMIRATECOUNT NUMBER;
A_FINELIMIT_DAYS NUMBER;
A_PENALTY_AMT NUMBER;
A_HAADFINE NUMBER;
A_NO_OF_DAYS NUMBER;
L_ERROR NVARCHAR2(500);
L_COMMISSIONCOUNT NUMBER;
L_COMMISSIONSNO NUMBER;L_COMMISSIONPKEY NUMBER;
BEGIN

SELECT * INTO ADDMEMPOLICYROW FROM IM_ADDMEMBERPOLICY WHERE ADDMEMBERPOLICYCODE=100000000000048307;




         

FOR MEMDET  IN (SELECT * FROM IM_ADDMEMBERDET WHERE ADDMEMBERPOLICYCODE = 100000000000048307 AND CATEGORYCODE =100000000000000003)


LOOP                
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 15, 0, 
15, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'PHARMACY BENEFIT MANAGEMENT', 10000000000000054, NULL);
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 0, 5849, 0, 
5849, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'BASE PREMIUM', NULL, NULL);
COMMIT;

INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 18, 0, 
18, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Hepatitis C', 100000000000001498, NULL);
COMMIT;


INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 19, 0, 
19, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Cancer', 100000000000001499, NULL);
COMMIT;


COMMIT; 
END LOOP;                      
COMMIT;


EXCEPTION WHEN OTHERS THEN
L_ERROR:= SQLERRM;   
DBMS_OUTPUT.PUT_LINE(L_ERROR);

END;
/



DECLARE

ADDMEMPOLICYROW  IM_ADDMEMBERPOLICY%ROWTYPE;
ATOTALDAYS NUMBER;
AAGE NUMBER;
AADDMEMBERDETCOUNTER NUMBER;
AADDMEMBERDETPKEY NUMBER;
ATTOTALAPPLYAMMOUNT NUMBER;
ATOTALPREMIMVALUE NUMBER;
ATOTALADDPREMIMVALUE NUMBER;
ATOTALFINALPREMIUM NUMBER;
ATOTALCOMMISIONVALUE NUMBER;
A_EMIRATECOUNT NUMBER;
A_FINELIMIT_DAYS NUMBER;
A_PENALTY_AMT NUMBER;
A_HAADFINE NUMBER;
A_NO_OF_DAYS NUMBER;
L_ERROR NVARCHAR2(500);
L_COMMISSIONCOUNT NUMBER;
L_COMMISSIONSNO NUMBER;L_COMMISSIONPKEY NUMBER;
BEGIN

SELECT * INTO ADDMEMPOLICYROW FROM IM_ADDMEMBERPOLICY WHERE ADDMEMBERPOLICYCODE=100000000000048307;




         

FOR MEMDET  IN (SELECT * FROM IM_ADDMEMBERDET WHERE ADDMEMBERPOLICYCODE = 100000000000048307 AND CATEGORYCODE =100000000000000019)


LOOP                
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 15, 0, 
15, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'PHARMACY BENEFIT MANAGEMENT', 10000000000000054, NULL);
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 0, 1575, 0, 
1575, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'BASE PREMIUM', NULL, NULL);
COMMIT;

INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 18, 0, 
18, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Hepatitis C', 100000000000001498, NULL);
COMMIT;


INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 19, 0, 
19, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Cancer', 100000000000001499, NULL);
COMMIT;


COMMIT; 
END LOOP;                      
COMMIT;


EXCEPTION WHEN OTHERS THEN
L_ERROR:= SQLERRM;   
DBMS_OUTPUT.PUT_LINE(L_ERROR);

END;
/



DECLARE

ADDMEMPOLICYROW  IM_ADDMEMBERPOLICY%ROWTYPE;
ATOTALDAYS NUMBER;
AAGE NUMBER;
AADDMEMBERDETCOUNTER NUMBER;
AADDMEMBERDETPKEY NUMBER;
ATTOTALAPPLYAMMOUNT NUMBER;
ATOTALPREMIMVALUE NUMBER;
ATOTALADDPREMIMVALUE NUMBER;
ATOTALFINALPREMIUM NUMBER;
ATOTALCOMMISIONVALUE NUMBER;
A_EMIRATECOUNT NUMBER;
A_FINELIMIT_DAYS NUMBER;
A_PENALTY_AMT NUMBER;
A_HAADFINE NUMBER;
A_NO_OF_DAYS NUMBER;
L_ERROR NVARCHAR2(500);
L_COMMISSIONCOUNT NUMBER;
L_COMMISSIONSNO NUMBER;L_COMMISSIONPKEY NUMBER;
BEGIN

SELECT * INTO ADDMEMPOLICYROW FROM IM_ADDMEMBERPOLICY WHERE ADDMEMBERPOLICYCODE=100000000000048307;




         

FOR MEMDET  IN (SELECT * FROM IM_ADDMEMBERDET WHERE ADDMEMBERPOLICYCODE = 100000000000048307 AND CATEGORYCODE =1)


LOOP                
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 15, 0, 
15, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'PHARMACY BENEFIT MANAGEMENT', 10000000000000054, NULL);
INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 0, 3897, 0, 
3897, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'BASE PREMIUM', NULL, NULL);
COMMIT;

INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 18, 0, 
18, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Hepatitis C', 100000000000001498, NULL);
COMMIT;


INSERT INTO CAPPS.IM_ADDMEMBERPREDETL
(ADDMEMPOLICYPREMIUMCODE, 
ADDMEMBERDETCODE, PREMIUM_TYPES, DEFAULTVALUE, CALC_METHOD, PREMIUM_VALUE, 
CREATEDIN, CREATEDON, CREATEDBY, LASTMODIFIEDON, LASTMODIFIEDBY, 
LEGALENTITYCODE, CUSTOMERCODE, LOCATIONCODE, SERIALNO, COMPANYCODE, 
DESCRIPTION, BENEFITCODE, ISADDED)
VALUES
(AV_SEQ_ADDPRE_PK.NEXTVAL, MEMDET.ADDMEMBERDETCODE, 2, 19, 0, 
19, NULL, NULL, NULL, NULL, 
NULL, NULL, NULL, 1, AV_SEQ_ADDPRE_SNO.NEXTVAL, 
1, 'Cancer', 100000000000001499, NULL);
COMMIT;


COMMIT; 
END LOOP;                      
COMMIT;


EXCEPTION WHEN OTHERS THEN
L_ERROR:= SQLERRM;   
DBMS_OUTPUT.PUT_LINE(L_ERROR);

END;
/


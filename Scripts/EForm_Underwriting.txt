SELECT  BRANCHNAME,DISTRIBUTORTYPE,DISTRIBUTORNAME,PLANNAME,HDR.PRODUCTNAME,COUNTRYREGION,CONTRACTNAME,HDR.MASTERCONTRACTNAME,CONTRACTEFFECTIVEDATE,
CONTRACTEXPIRYDATE,BENEFICIARYSTARTDATE,BENEFICIARYENDDATE,CONTRACTINCEPTIONDATE,POLICYNUMBER,RENEWALNUMBER,POLICYSTATUS, HDR.CARDNUMBER,
PRINCIPALID,BENEFICIARYFIRSTNAME,BENEFICIARYMIDDLENAME,BENEFICIARYLASTNAME,DEPENDENCY,DATEOFBIRTH,GENDER,BENEFICIARYNATIONALITY,CARDNUMBER,
LASTCARDNUMBER,ENDORESMENTDATE,ENDORESMENTISSUEDATE,ENDORESMENTID,ENDORESMENTTYPE,MANAGEDBY,ADDPREMIUM,REFUNDPREMIUM,IPPREMIUM,OPPREMIUM,
TOTALPREMIUM,UWYEAR,AGE,MARITALSTATUS,SALARYBAND,AGENTCOM,ADMINFEE,TPAFEE,HDR.POLICYTYPE,
(SELECT GETANNUALLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER) FROM DUAL) ANNUALLIMIT,
(SELECT GETBENEFITLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000048) FROM DUAL) OPLIMIT,
(SELECT GETBENEFITLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000035)  FROM DUAL) MATLIMIT,
(SELECT GETBENEFITLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000113) FROM DUAL) DENTALLIMIT,
(SELECT GETBENEFITLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000105) FROM DUAL) OPTICALLIMIT,
(SELECT GETBENEFITLIMIT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000054) FROM DUAL) PBMLIMIT,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000017) FROM DUAL) IPDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000017) FROM DUAL) IPCOINSURANCE,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000048) FROM DUAL) OPDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000048) FROM DUAL) OPCOINSURANCE,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000035) FROM DUAL) MATDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000035) FROM DUAL) MATCOINSURANCE,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000113) FROM DUAL) DENTALDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000113) FROM DUAL) DENTALCOINSURANCE,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000105) FROM DUAL) OPTICALDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000105) FROM DUAL) OPTICALCOINSURANCE,
(SELECT GETDEDUCTAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000054) FROM DUAL) PBMDEDUCTIBLE,
(SELECT GETCOINSAMOUNT(1,NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE), HDR.CARDNUMBER,10000000000000054)  FROM DUAL)PBMCOINSURANCE,
(SELECT GETACTUARYBENEFITPREMIUM(NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),10000000000000105, HDR.CARDNUMBER,HDR.ENDORESMENTID)  FROM DUAL)OPTICALPREMIUM,
(SELECT GETACTUARYBENEFITPREMIUM(NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),10000000000000054, HDR.CARDNUMBER,HDR.ENDORESMENTID)  FROM DUAL)PBMPREMIUM,
(SELECT GETACTUARYBENEFITPREMIUM(NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),10000000000000113, HDR.CARDNUMBER,HDR.ENDORESMENTID)  FROM DUAL)DENTALPREMIUM, 
(SELECT GETNETWORKNAME(NVL(P.A_POLICYTYPE,IP.A_POLICYTYPE),NVL(P.POLICYCODE,IP.INDIVIDUALPOLICYCODE)) FROM DUAL) NETWORKNAME FROM IM_EFORM_UW_HDR  HDR
LEFT JOIN IM_POLICY P ON P.POLICYID = HDR.POLICYNUMBER AND HDR.POLICYTYPE = 'Group'
LEFT JOIN IM_INDIVIDUALPOLICY IP ON IP.POLICYID = HDR.POLICYNUMBER AND HDR.POLICYTYPE = 'Individual'
WHERE  To_Date(ENDORESMENTDATE,'DD/MM/RRRR') BETWEEN To_Date('01/07/2018','DD/MM/RRRR') AND  To_Date('31/07/2018','DD/MM/RRRR') 
                                                   
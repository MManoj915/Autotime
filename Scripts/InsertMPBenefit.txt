BEGIN
FOR HDR IN(SELECT DISTINCT CATEGORYCODE,MEMBERPOLICYCODE FROM IM_MEMBERPOLICY WHERE POLICYCODE=100000000000022384) LOOP
FOR DTL IN (SELECT DISTINCT BENEFITCODE,LIMITS FROM IM_POLICY_BENEFITSETTING WHERE POLICYCODE=100000000000022384
AND CATEGORYCODE = HDR.CATEGORYCODE
AND BENEFITCODE NOT IN
(SELECT BENEFITCODE FROM IM_MEMBERPOLICYBENEFITDTL WHERE MEMBERPOLICYCODE = HDR.MEMBERPOLICYCODE)) LOOP
Insert into CAPPS.IM_MEMBERPOLICYBENEFITDTL
(MEMBERPOLICYBENEFITDTLCODE,
MEMBERPOLICYCODE, BENEFITCODE, BENEFITINSURERCODE, SUMINSURER, COMPANYCODE,
CREATEDBY, LASTMODIFIEDBY, CREATEDON, LASTMODIFIEDON, LOCATIONCODE,
SERIALNO, BENEFITLIMIT, MANUALADDED)
Values
((SELECT MAX(MEMBERPOLICYBENEFITDTLCODE) + 1 FROM IM_MEMBERPOLICYBENEFITDTL), HDR.MEMBERPOLICYCODE, DTL.BENEFITCODE, NULL, NULL,
1, 100000000000000657, 100000000000000657, TO_DATE('01/09/2017 12:15:14', 'MM/DD/YYYY HH24:MI:SS'), TO_DATE('01/09/2017 12:15:14', 'MM/DD/YYYY HH24:MI:SS'),
1, (SELECT MAX(SERIALNO) + 1 FROM IM_MEMBERPOLICYBENEFITDTL), 0, NULL);
COMMIT;  
END LOOP;
END LOOP; 
END;





 
SELECT MPOL.ACARDID CARDNO,MPOL.AMEMBERID MEMBERID,MPOL.APOLICYID POLICYID,MPOL.APOLICYNAME POLICYNAME,CAT.CATEGORY_ID,GEN6.CONSTANTNAME MEMBERSTATUS,
BRO.BROKER_NAME_EN SOURCENAME,HR.SHORT_NAME BRANCHNAME,MEM.FIRST_NAME FIRSTNAME,MEM.MIDDLENAME,MEM.LAST_NAME FAMILYNAME,
NVL(MEM.MOBILE_NO,MEM.MOBILE_NUMBER) CONTACTNUMBER,TO_CHAR(MEM.DATE_OF_BIRTH,'DD/MM/RRRR') BIRTHDATE,
G.CONSTANTNAME GENDER,G1.CONSTANTNAME NATIONALITY,MEM.PASSPORT_NO,G2.CONSTANTNAME MARITALSTATUS,
Nvl(MEM.EMAILID,MEM.EMAIL_ID)EMAILID,MEM.EMIRATES_ID,GENC1.CONSTANTNAME RESIDENTLOCATION,
GENC2.CONSTANTNAME WORKLOCATION,GENC3.CONSTANTNAME SALARYBAND,GENC4.CONSTANTNAME ISCOMMISSION,
EMI.PROVINCENAME,MEM.UIDNUMBER,GEN2.CONSTANTNAME RELATION,NVL (MEM.CARDID, IM.CARDID) RELATIONTO,
'INS038' PAYERID,To_Char(MPOL.MEMBERSTARTDATE,'DD/MM/RRRR') ENDORESMENTDATE,
To_Char(Nvl(MPOL.MEMBERENDDATE,MPOL.POLICYENDDDATE)) DELETIONDATE,
(SELECT SUM (PREMIUM_VALUE)
FROM IM_MEMBERPOLICYPREMIUMDTL DTL
WHERE DTL.MEMBERPOLICYCODE = MPOL.MEMBERPOLICYCODE)
GROSSPREMIUM,GENC5.CONSTANTNAME ENTITYTYPE,
NVL (MEM.MEMBERENTITYIDNAME, NVL (MPOL.UIDNUMBER, MEM.UIDNUMBER))
ENTITYID FROM IM_MEMBERPOLICY MPOL
JOIN IM_POLICY POL ON POL.POLICYCODE = MPOL.POLICYCODE
JOIN IM_BROKERS BRO ON BRO.BROKERCODE = POL.BROKERCODE
JOIN HR_ORGANIZATIONS_D HR ON HR.ORGANIZATIONS_CODE= POL.BRANCHCODE
JOIN IM_MEMBERS MEM ON MEM.MEMBER_CODE = MPOL.MEMBERCODE
LEFT JOIN GENCONSTANT G ON G.CONSTANTVALUE = MEM.GENDER AND G.CATEGORY='GENDER' AND Upper(G.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G1 ON G1.CONSTANTVALUE = MEM.NATIONALITY AND G1.CATEGORY='FND_NATIONALITY' AND Upper(G1.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT G2 ON G2.CONSTANTVALUE = MEM.MARITAL_STATUS AND G2.CATEGORY='MARITAL_STATUS' AND Upper(G2.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GENC1 ON GENC1.CATEGORY = 'MEMBERLOCATION' AND GENC1.CONSTANTVALUE = MEM.RESIDENTLOCATION AND Upper(GENC1.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GENC2 ON GENC2.CATEGORY = 'MEMBERLOCATION' AND GENC2.CONSTANTVALUE = MEM.WORKLOCATION AND Upper(GENC2.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENPROVINCE EMI ON EMI.PROVINCECODE = MEM.EMIRATECODE 
LEFT JOIN GENCONSTANT GENC3 ON GENC3.CATEGORY = 'SALARYBANDTYPE' AND GENC3.CONSTANTVALUE = MEM.SALARYBAND AND Upper(GENC3.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GENC4 ON  GENC4.CATEGORY = 'MEMYSENO' AND GENC4.CONSTANTVALUE = MEM.ISCOMMISSION AND Upper(GENC4.LANGUAGECODE) = 'EN-US'
LEFT JOIN GENCONSTANT GEN2 ON     GEN2.CONSTANTVALUE = MEM.RELATION AND GEN2.CATEGORY = 'MEMBERRELATION' AND UPPER (GEN2.LANGUAGECODE) = 'EN-US'
LEFT JOIN IM_MEMBERS_REGISTER IM ON IM.MEMBER_CODE = MEM.PARENT_ID
LEFT JOIN GENCONSTANT GEN6 ON GEN6.CATEGORY = 'CUSSTATUS' AND GEN6.CONSTANTVALUE = MEM.STATUS AND GEN6.LANGUAGECODE = 'en-US' 
JOIN IM_CATEGORIES CAT ON CAT.CATEGORY_CODE = MPOL.CATEGORYCODE 
LEFT JOIN GENCONSTANT GENC5 ON     GENC5.CATEGORY = 'ENTITYTYPE' AND GENC5.CONSTANTVALUE = MEM.ENTITYTYPE AND Upper(GENC5.LANGUAGECODE) = 'EN-US'
WHERE POLICYID = '0505-02'
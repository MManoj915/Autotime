SELECT GROUP_NAME,SUM(PREMIUMAMOUNT),SUM(COMMISSIONAMOUNT) FROM(SELECT GRP.GROUP_NAME,
(SELECT decode(memotype,0,AMOUNT,amount*-1) FROM IM_NGI_JVPOSTING WHERE REF_CODE = JV.REF_CODE AND JVPREMIUMTYPE = 0) PREMIUMAMOUNT,
(SELECT  decode(memotype,0,AMOUNT,amount*-1) FROM IM_NGI_JVPOSTING WHERE REF_CODE = JV.REF_CODE AND JVPREMIUMTYPE <> 0
AND BROKERCODE=10000000000000015) COMMISSIONAMOUNT,
(SELECT REF_NO FROM IM_NGI_JVPOSTING WHERE REF_CODE = JV.REF_CODE AND JVPREMIUMTYPE <> 0
AND BROKERCODE=10000000000000015) DOCUMENTNO
FROM IM_NGI_JVPOSTING JV
JOIN IM_GROUPS GRP ON GRP.GROUP_CODE = JV.GROUPCODE
WHERE REF_CODE IN(
SELECT REF_CODE FROM IM_NGI_JVPOSTING WHERE BROKERCODE=10000000000000015 AND POLICYCODE IN(
SELECT POLICYCODE FROM IM_POLICY WHERE POLICYID LIKE '%4233-0%'))) GROUP BY GROUP_NAME